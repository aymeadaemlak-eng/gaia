<!DOCTYPE html>
<html lang="tr">
<head>
  <script>
    /*
      === EXTERNAL CONTROL POINT ===
      Do NOT set true/false inside this file.

      Set this variable from Bubble / backend / parent frame / external JS:

        window.setEvraklarYuklendi(true);   // enable Calculate button
        window.setEvraklarYuklendi(false);  // disable Calculate button
    */

    window.EVRAKLAR_YUKLENDI = false;

    window.setEvraklarYuklendi = function (value) {
      window.EVRAKLAR_YUKLENDI = value === true;
    };
  </script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Değer Kaybı Otomasyonu</title>
  <script>
    // === KONFIGURASYON (en üst) ===
    // Evraklar yüklendiyse true, değilse false yapın.
    if (typeof window.RESULT_DATA_JSON === "undefined") {
      window.RESULT_DATA_JSON = "";
    }
    // JSON'u buraya yapıştırmak yerine aşağıdaki <script id="resultDataJson"> içine
    // ham JSON olarak (tırnak/backtick olmadan) yapıştırmanız önerilir.
    // Bu durumda window.RESULT_DATA_JSON boş kalabilir.
  </script>
  <!--
    JSON'u tam olarak aşağıdaki script etiketi içine yapıştırın:
    <script id="resultDataJson" type="application/json">
      { ... JSON BURAYA ... }
    </script>

    Bu yöntem, çok satırlı veri ve özel karakterlerde SyntaxError hatasını engeller.
    Evraklar yüklendiyse yukarıda window.EVRAKLAR_YUKLENDI = true yapın.
  -->
  <script id="resultDataJson" type="application/json"></script>
  <style>
    :root {
      color-scheme: light;
      font-family: "Inter", "Segoe UI", system-ui, -apple-system, sans-serif;
      --bg: #f4f6f8;
      --card: #ffffff;
      --text: #333333;
      --muted: #5f6b7a;
      --primary: #195aa7;
      --primary-dark: #2a74d2;
      --border: #e4e8f0;
      --success: #0a7b42;
      --warning: #f59e0b;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background: radial-gradient(circle at top, #ffffff 0%, #f4f6f8 45%, #e9eef5 100%);
      color: var(--text);
    }

    #app {
      min-height: 100vh;
      padding: 20px;
    }

    .layout {
      display: grid;
      gap: 24px;
    }

    #app[data-result-mode="true"] #stageTwo {
      order: 0;
    }

    #app[data-result-mode="true"] #stageOne {
      order: 1;
    }

    #app[data-pre-result-mode="true"] #stageTwo {
      order: 0;
    }

    #app[data-pre-result-mode="true"] #stageOne {
      order: 1;
    }

    #app[data-result-mode="true"] .required-docs {
      display: none;
    }

    #app[data-pre-result-mode="true"] .required-docs {
      display: none;
    }

    #app[data-pre-result-mode="true"] .result-cta,
    #app[data-pre-result-mode="true"] .result-cta-secondary {
      display: none;
    }

    #app[data-pre-result-mode="true"] #primaryCta {
      display: none;
    }

    #app[data-result-mode="true"] #stageTwo .summary-card,
    #app[data-pre-result-mode="true"] #stageTwo .summary-card {
      order: 0;
    }

    #app[data-result-mode="true"] #stageTwo .card-grid,
    #app[data-pre-result-mode="true"] #stageTwo .card-grid {
      order: 1;
    }

    #app[data-result-mode="true"] #stageTwo .app-bar,
    #app[data-pre-result-mode="true"] #stageTwo .app-bar {
      order: 2;
    }

    #app[data-result-mode="true"] #stageTwo .hero-card,
    #app[data-pre-result-mode="true"] #stageTwo .hero-card {
      order: 3;
    }

    .card {
      background: var(--card);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08);
      border: 1px solid var(--border);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 16px 36px rgba(15, 23, 42, 0.12);
    }

    h1, h2, h3, h4 {
      margin: 0 0 12px;
    }

    p {
      margin: 0 0 12px;
      color: var(--muted);
      line-height: 1.5;
    }

    .stack {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .grid {
      display: grid;
      gap: 20px;
    }

    .main-panel {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .hero {
      display: grid;
      gap: 16px;
    }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }

    .hero-card {
      padding: 28px;
      border-radius: 20px;
      background: linear-gradient(135deg, #ffffff 15%, #eef4ff 65%, #f7fbff 100%);
      border: 1px solid #dbe4f5;
      box-shadow: 0 20px 40px rgba(15, 23, 42, 0.08);
    }

    .summary-card {
      display: grid;
      gap: 16px;
      padding: 20px;
      border-radius: 18px;
      border: 1px solid #d9e2f4;
      background: linear-gradient(135deg, #ffffff 0%, #f5f8ff 100%);
      box-shadow: 0 18px 36px rgba(15, 23, 42, 0.08);
    }

    .summary-header {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
    }

    .summary-amount {
      font-size: 28px;
      font-weight: 700;
      color: var(--primary-dark);
    }

    .summary-meta {
      font-size: 14px;
      color: var(--muted);
    }

    .summary-security-note {
      font-size: 13px;
      color: var(--muted);
    }

    .summary-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .summary-actions .outline-button,
    .summary-actions .primary {
      min-width: 180px;
    }

    .hero-top {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .hero-title {
      font-size: 28px;
      line-height: 1.2;
      margin-bottom: 8px;
    }

    .hero-actions-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      color: var(--primary);
      text-decoration: none;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(25, 90, 167, 0.12);
      transition: background 0.2s ease, transform 0.2s ease;
    }

    .hero-actions-link:hover {
      text-decoration: underline;
      background: rgba(25, 90, 167, 0.2);
      transform: translateY(-1px);
    }

    .secure-note {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 999px;
      background: #eef7f2;
      color: #0a5f38;
      font-size: 13px;
      font-weight: 600;
    }

    .secure-meta {
      display: block;
      margin-top: 6px;
      font-size: 12px;
      color: var(--muted);
      font-weight: 500;
    }

    .badge {
      display: inline-flex;
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(25, 90, 167, 0.1);
      color: var(--primary);
      font-weight: 600;
      font-size: 12px;
      letter-spacing: 0.3px;
      text-transform: uppercase;
    }

    .toast {
      display: none;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      padding: 14px 18px;
      border-radius: 12px;
      border: 1px solid transparent;
      font-weight: 600;
      font-size: 14px;
    }

    .toast-success {
      background: #ecfdf3;
      border-color: #bbf7d0;
      color: #166534;
    }

    .toast-error {
      background: #fef2f2;
      border-color: #fecaca;
      color: #991b1b;
    }

    .progress {
      display: grid;
      gap: 12px;
    }

    .progress-step {
      display: flex;
      gap: 12px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: #fdfdff;
      align-items: center;
    }

    .progress-step span {
      font-weight: 700;
      color: var(--primary);
      background: rgba(25, 90, 167, 0.1);
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    label {
      font-weight: 600;
      font-size: 14px;
    }

    input[type="file"] {
      padding: 16px;
      border: 2px dashed #cfd8e6;
      border-radius: 14px;
      background: #f9fafc;
    }

    button {
      border: none;
      padding: 14px 18px;
      border-radius: 12px;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      background: var(--primary);
      color: #fff;
      transition: background 0.2s ease;
    }

    button:hover {
      background: var(--primary-dark);
    }

    button:disabled {
      background: #9db8f3;
      cursor: not-allowed;
    }

    .note {
      padding: 12px;
      border-radius: 12px;
      background: #f2f6ff;
      color: var(--muted);
      font-size: 14px;
    }

    .info {
      padding: 16px;
      border-radius: 14px;
      border: 1px solid #fde68a;
      background: #fffbeb;
      color: #92400e;
      font-size: 14px;
    }

    .status {
      padding: 12px;
      border-radius: 12px;
      background: #f4f8f3;
      border: 1px solid #c9e7d4;
      color: var(--success);
      font-weight: 600;
      font-size: 14px;
    }

    .status-card {
      display: grid;
      gap: 16px;
    }

    .process-card {
      display: grid;
      gap: 12px;
    }

    .process-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .process-tag {
      font-size: 12px;
      font-weight: 600;
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(25, 90, 167, 0.12);
      color: var(--primary);
    }

    .process-stepper {
      position: relative;
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 0;
      padding: 0 2px;
    }

    .process-stepper.is-extended {
      display: flex;
      overflow-x: auto;
      gap: 12px;
      padding: 0 2px 8px;
      scroll-snap-type: x proximity;
    }

    .process-stepper::before {
      content: "";
      position: absolute;
      top: 14px;
      left: 28px;
      right: 28px;
      height: 2px;
      background: #e6ecf5;
      z-index: 0;
    }

    .process-stepper.is-extended::before {
      content: none;
    }

    .process-step {
      display: grid;
      gap: 4px;
      justify-items: center;
      text-align: center;
      position: relative;
      z-index: 1;
      padding: 0 4px;
    }

    .process-stepper.is-extended .process-step {
      flex: 0 0 auto;
      min-width: 128px;
      scroll-snap-align: start;
    }

    .process-stepper.is-extended .process-step:not(:first-child)::before {
      content: "";
      position: absolute;
      top: 14px;
      left: -18px;
      width: 18px;
      height: 2px;
      background: #e6ecf5;
      z-index: -1;
    }

    .process-circle {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: grid;
      place-items: center;
      font-size: 13px;
      font-weight: 700;
      background: #eef2f8;
      color: #7b8798;
      border: 2px solid #dde4ef;
    }

    .process-label {
      font-size: 12px;
      color: var(--muted);
      font-weight: 600;
    }

    .process-step.done .process-circle {
      background: #ecfdf3;
      border-color: #bbf7d0;
      color: #166534;
    }

    .process-step.active .process-circle {
      background: rgba(25, 90, 167, 0.12);
      border-color: rgba(25, 90, 167, 0.45);
      color: var(--primary);
    }

    .process-step.active .process-label {
      color: var(--text);
    }

    .process-step.active:not(:last-child)::after {
      content: "";
      position: absolute;
      top: 14px;
      left: 50%;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, rgba(25, 90, 167, 0.25), rgba(25, 90, 167, 0.85));
      animation: process-flow 1.6s ease-in-out infinite;
      z-index: -1;
    }

    @keyframes process-flow {
      0% {
        opacity: 0.2;
        transform: scaleX(0.6);
      }
      50% {
        opacity: 1;
        transform: scaleX(1);
      }
      100% {
        opacity: 0.2;
        transform: scaleX(0.6);
      }
    }

    .process-step.error .process-circle {
      background: #fef2f2;
      border-color: #fecaca;
      color: #991b1b;
    }

    .process-body {
      display: grid;
      gap: 8px;
    }

    .process-title {
      font-size: 18px;
      margin: 0;
    }

    .process-subtitle {
      margin: 0;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.5;
    }

    .process-mini {
      display: grid;
      gap: 6px;
      font-size: 13px;
      color: var(--muted);
    }

    .process-mini span strong {
      color: var(--text);
    }

    .process-cta {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px 16px;
      border-radius: 10px;
      background: var(--primary);
      color: #fff;
      font-weight: 600;
      text-decoration: none;
      width: fit-content;
    }

    .process-cta:hover {
      background: var(--primary-dark);
    }

    .process-note {
      font-size: 12px;
      color: var(--muted);
    }

    .process-details {
      display: none;
      gap: 12px;
      padding: 16px;
      border-radius: 16px;
      border: 1px solid #f4d4b6;
      background: linear-gradient(135deg, rgba(255, 247, 237, 0.95), rgba(255, 244, 230, 0.7));
      color: #8a4b14;
    }

    .process-details-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .process-details h4 {
      margin: 0;
      font-size: 15px;
      color: #7a3e12;
    }

    .process-details p {
      margin: 0;
      font-size: 13px;
      color: #8a4b14;
    }

    .process-details-badge {
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(194, 65, 12, 0.12);
      color: #9a3412;
      font-size: 11px;
      font-weight: 700;
    }

    .process-details-list {
      display: grid;
      gap: 8px;
      margin: 0;
      padding: 0;
      list-style: none;
      max-height: 260px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .process-details-list li {
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid rgba(194, 65, 12, 0.2);
      background: rgba(255, 247, 237, 0.8);
      font-size: 13px;
      color: #7c3a11;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      opacity: 0.45;
    }

    .process-details-list li.is-active {
      opacity: 1;
      background: rgba(255, 237, 213, 0.95);
      border-color: rgba(194, 65, 12, 0.35);
    }

    .process-details-list li.is-costly {
      color: #9f1239;
      border-color: rgba(190, 24, 93, 0.45);
      background: rgba(255, 228, 230, 0.7);
    }

    .process-details-list li.is-costly.is-active {
      background: rgba(255, 205, 210, 0.9);
      color: #9f1239;
    }

    .status-title {
      font-size: 18px;
      margin-bottom: 0;
    }

    .status-text {
      font-size: 24px;
      font-weight: 700;
      color: var(--text);
    }

    .status-subtitle {
      margin: 0;
      color: var(--muted);
    }

    .status-progress {
      height: 10px;
      border-radius: 999px;
      background: #e8eef9;
      overflow: hidden;
      position: relative;
    }

    .status-progress::after {
      content: "";
      position: absolute;
      inset: 0;
      width: 45%;
      background: linear-gradient(90deg, rgba(25, 90, 167, 0.2), rgba(25, 90, 167, 0.8));
      animation: progressMove 2s infinite ease-in-out;
    }

    @keyframes progressMove {
      0% {
        transform: translateX(-60%);
      }
      100% {
        transform: translateX(200%);
      }
    }

    .result-card {
      display: grid;
      gap: 16px;
    }

    .result-empty {
      display: grid;
      gap: 12px;
      align-items: center;
      text-align: center;
      padding: 12px 8px 18px;
    }

    .result-empty-icon {
      width: 64px;
      height: 64px;
      border-radius: 18px;
      margin: 0 auto;
      display: grid;
      place-items: center;
      background: #eef2ff;
      color: #4338ca;
    }

    .result-amount {
      font-size: 32px;
      font-weight: 700;
      color: var(--text);
    }

    .result-meta {
      font-size: 13px;
      color: var(--muted);
    }

    .petition-card {
      display: grid;
      gap: 16px;
    }

    .preview {
      padding: 14px;
      border-radius: 12px;
      border: 1px dashed #cfd8e6;
      background: #f8fafc;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.6;
      position: relative;
      overflow: hidden;
    }

    .preview::after {
      content: "";
      position: absolute;
      inset: 0;
      backdrop-filter: blur(4px);
      background: rgba(255, 255, 255, 0.6);
    }

    .preview.active::after {
      display: none;
    }

    .petition-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .petition-actions button {
      background: #fff;
      color: var(--primary);
      border: 1px solid #d7e3f8;
    }

    .petition-actions button.primary {
      background: var(--primary);
      color: #fff;
      border: none;
    }

    .card-grid {
      display: grid;
      gap: 16px;
    }

    #referencesSlot {
      display: grid;
      grid-column: 1 / -1;
    }

    .state-section {
      display: none;
    }

    [data-ui-state="empty"] .state-empty,
    [data-ui-state="loading"] .state-loading,
    [data-ui-state="success"] .state-success,
    [data-ui-state="error"] .state-error {
      display: block;
    }

    [data-ui-state="success"] .toast-success,
    [data-ui-state="error"] .toast-error {
      display: flex;
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.45);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      z-index: 2000;
    }

    .modal-backdrop.active {
      display: flex;
    }

    .modal {
      background: #fff;
      border-radius: 16px;
      max-width: 560px;
      width: 100%;
      padding: 24px;
      box-shadow: 0 20px 40px rgba(15, 23, 42, 0.2);
    }

    body.modal-open {
      overflow: hidden;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .modal-close {
      background: transparent;
      color: var(--muted);
      border: none;
      font-size: 16px;
      cursor: pointer;
    }

    .steps {
      display: grid;
      gap: 12px;
    }

    .step {
      display: flex;
      gap: 12px;
      align-items: center;
      padding: 12px;
      border-radius: 12px;
      background: #f8fafc;
      border: 1px solid #e2e8f0;
    }

    .step span {
      width: 36px;
      height: 36px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      background: rgba(25, 90, 167, 0.12);
      color: var(--primary);
      font-weight: 700;
    }

    .list {
      margin: 0;
      padding-left: 18px;
      color: var(--muted);
    }

    .app-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 14px 16px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: #ffffff;
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.08);
    }

    .app-bar-brand {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      color: var(--text);
    }

    .app-bar-logo {
      width: 36px;
      height: 36px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      background: rgba(25, 90, 167, 0.12);
      color: var(--primary);
      font-weight: 700;
    }

    .app-bar-title {
      font-size: 14px;
      color: var(--muted);
      font-weight: 600;
    }

    .is-hidden {
      display: none !important;
    }

    @media (max-width: 719px) {
      .layout {
        display: flex;
        flex-direction: column;
      }

      #stageTwo {
        order: 2;
      }

      #stageOne {
        order: 1;
        padding: 14px;
      }

      #stageOne h1 {
        font-size: 18px;
      }

      #stageOne .list {
        display: none;
      }

      .stage-one {
        gap: 14px;
      }

      .hero-title-lg {
        font-size: 22px;
      }

      .cta-block {
        padding: 14px;
        gap: 8px;
      }

      .required-docs {
        padding: 8px 10px;
        gap: 6px;
        font-size: 13px;
        line-height: 1.35;
      }

      .cta-button {
        margin-top: 4px;
        margin-bottom: 4px;
        position: sticky;
        bottom: 12px;
        z-index: 2;
      }

      .cta-meta {
        font-size: 12px;
      }

      .cta-warning {
        font-size: 12px;
      }
    }

    .result {
      border: 1px solid #d7e3f8;
      background: #f3f7ff;
      border-radius: 12px;
      padding: 16px;
    }

    .result a {
      display: inline-flex;
      margin-top: 8px;
      color: var(--primary);
      font-weight: 600;
      text-decoration: none;
    }

    .result a:hover {
      text-decoration: underline;
    }

    .meta {
      display: grid;
      gap: 8px;
      font-size: 14px;
      color: var(--muted);
    }

    .meta strong {
      color: var(--text);
    }

    .upload-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }

    .upload-actions button {
      flex: 1;
      min-width: 220px;
    }

    .help-card ul {
      margin: 0;
      padding-left: 18px;
      color: var(--muted);
    }

    .doc-requirements {
      display: grid;
      gap: 10px;
      padding: 14px;
      border-radius: 14px;
      border: 1px solid #dbeafe;
      background: #f0f7ff;
      color: var(--text);
      font-size: 14px;
    }

    .doc-requirements strong {
      font-size: 15px;
    }

    .doc-requirements ul {
      margin: 0;
      padding-left: 18px;
      color: var(--muted);
    }

    .trust-card {
      display: grid;
      gap: 12px;
      padding: 14px;
      border-radius: 14px;
      border: 1px solid #e2e8f0;
      background: #f8fafc;
      font-size: 14px;
      color: var(--muted);
    }

    .trust-card ul {
      margin: 0;
      padding-left: 18px;
    }

    .stage-one {
      display: grid;
      gap: 16px;
    }

    .trust-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 10px 16px;
      border-radius: 14px;
      background: #f0f6ff;
      border: 1px solid #dbe7ff;
      font-size: 13px;
      color: #2b3b55;
    }

    .trust-bar-items {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }

    .trust-item {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
    }

    .trust-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #195aa7;
    }

    .trust-link {
      color: var(--primary);
      font-weight: 600;
      text-decoration: none;
    }

    .trust-link:hover {
      text-decoration: underline;
    }

    .hero-block {
      padding: 24px;
      border-radius: 18px;
      background: #ffffff;
      border: 1px solid var(--border);
      box-shadow: 0 14px 30px rgba(15, 23, 42, 0.08);
      display: grid;
      gap: 12px;
    }

    .hero-cta-group {
      display: grid;
      gap: 8px;
      justify-items: start;
    }

    .hero-cta {
      padding: 14px 20px;
      border-radius: 12px;
      font-size: 15px;
      box-shadow: 0 12px 22px rgba(25, 90, 167, 0.18);
    }

    .hero-cta-note {
      font-size: 12px;
      color: var(--muted);
      font-weight: 600;
    }

    .trust-infra-block {
      padding: 22px;
      border-radius: 20px;
      border: 1px solid #d9e2ef;
      background: #ffffff;
      box-shadow: 0 16px 32px rgba(15, 23, 42, 0.08);
      display: grid;
      gap: 16px;
    }

    .trust-infra-list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: 12px;
    }

    .trust-infra-item {
      display: flex;
      gap: 12px;
      align-items: flex-start;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
      background: #f4f6f8;
      color: var(--text);
      font-size: 14px;
      line-height: 1.4;
    }

    .trust-infra-item span {
      color: var(--text);
      font-weight: 600;
    }

    .trust-subline {
      display: block;
      margin-top: 6px;
      font-size: 12px;
      color: #6b7280;
      font-weight: 500;
    }

    .trust-subline strong {
      font-weight: 600;
    }

    .trust-infra-icon {
      width: 32px;
      height: 32px;
      border-radius: 10px;
      display: grid;
      place-items: center;
      background: rgba(25, 90, 167, 0.12);
      color: var(--primary);
      flex-shrink: 0;
    }

    .trust-logos {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      align-items: stretch;
    }

    .trust-logo-card {
      border-radius: 14px;
      border: 1px solid #d7dee9;
      background: #f4f6f8;
      display: grid;
      place-items: center;
      padding: 14px;
      min-height: 72px;
      transition: box-shadow 0.2s ease, transform 0.2s ease;
    }

    .trust-logo-card img {
      max-width: 120px;
      max-height: 28px;
      width: 100%;
      height: auto;
      filter: grayscale(100%);
      opacity: 0.7;
    }

    .trust-logo-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(15, 23, 42, 0.08);
    }

    .trust-docs {
      border-radius: 16px;
      border: 1px solid #d7dee9;
      background: #f4f6f8;
      padding: 14px 16px;
    }

    .trust-docs summary {
      cursor: pointer;
      font-weight: 600;
      color: #475569;
      list-style: none;
    }

    .trust-docs summary::-webkit-details-marker {
      display: none;
    }

    .trust-doc-card {
      margin-top: 12px;
      padding: 12px 14px;
      border-radius: 12px;
      border-left: 3px solid #c7d2e7;
      background: #eef2f7;
      font-family: "SFMono-Regular", "Consolas", "Liberation Mono", monospace;
      font-size: 12.5px;
      color: #475569;
      display: grid;
      gap: 8px;
    }

    .trust-doc-line {
      line-height: 1.5;
    }

    .trust-doc-card strong {
      font-weight: 600;
      color: #334155;
    }

    .trust-footer {
      display: grid;
      gap: 6px;
      font-size: 13px;
      color: var(--muted);
    }

    .trust-footer strong {
      color: var(--text);
    }

    .info-block {
      padding: 20px;
      border-radius: 18px;
      border: 1px solid #d9e2ef;
      background: #ffffff;
      box-shadow: 0 14px 28px rgba(15, 23, 42, 0.06);
      display: grid;
      gap: 12px;
    }

    .info-grid {
      display: grid;
      gap: 12px;
    }

    .info-item {
      padding: 14px;
      border-radius: 14px;
      border: 1px solid #e2e8f0;
      background: #f4f6f8;
      display: grid;
      gap: 6px;
    }

    .info-item h3 {
      margin: 0;
      font-size: 15px;
    }

    .info-item p {
      margin: 0;
      font-size: 13px;
    }

    .hero-title-lg {
      font-size: 26px;
      line-height: 1.25;
    }

    .hero-subtitle {
      font-size: 15px;
      color: var(--muted);
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .pill {
      padding: 6px 14px;
      border-radius: 999px;
      background: rgba(25, 90, 167, 0.12);
      color: #195aa7;
      font-weight: 600;
      font-size: 12px;
    }

    .steps-block {
      display: grid;
      gap: 12px;
    }

    .steps-grid {
      display: grid;
      gap: 12px;
    }

    .required-docs {
      display: grid;
      gap: 6px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #e3e7ef;
      background: #f5f7fa;
      color: var(--text);
      font-size: 13.5px;
      line-height: 1.4;
      justify-items: start;
      text-align: left;
      transition: opacity 0.2s ease;
    }

    .required-docs.is-secondary {
      opacity: 0.6;
    }

    .required-docs-summary {
      display: grid;
      gap: 4px;
    }

    .required-docs-summary strong {
      font-weight: 600;
    }

    .required-docs-meta {
      color: var(--muted);
      font-size: 12px;
    }

    .required-docs-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #6b7280;
      font-size: 12px;
      text-decoration: none;
    }

    .required-docs-link:hover {
      text-decoration: underline;
    }

    .required-docs-logo {
      width: 16px;
      height: 16px;
      border-radius: 4px;
      display: inline-block;
      object-fit: cover;
    }

    .required-docs-external {
      width: 14px;
      height: 14px;
    }

    .step-card {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid #e2e8f0;
      background: #f8fafc;
    }

    .step-icon {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      background: rgba(25, 90, 167, 0.12);
      color: var(--primary);
    }

    .lawyers-block {
      display: grid;
      gap: 14px;
    }

    .lawyers-grid {
      display: grid;
      gap: 14px;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    }

    .lawyer-card {
      position: relative;
      padding: 16px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: #ffffff;
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.06);
      display: grid;
      gap: 10px;
    }

    .lawyer-tag {
      align-self: flex-start;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(25, 90, 167, 0.12);
      color: var(--primary);
      font-size: 11px;
      font-weight: 700;
    }

    .lawyer-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 10px;
    }

    .lawyer-profile {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .lawyer-avatar {
      width: 52px;
      height: 52px;
      border-radius: 999px;
      background: linear-gradient(135deg, #e3ecff, #f8fbff);
      display: grid;
      place-items: center;
      color: #3558b8;
      font-weight: 700;
    }

    .lawyer-meta {
      display: grid;
      gap: 4px;
    }

    .lawyer-name {
      font-weight: 700;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 2;
      overflow: hidden;
    }

    .lawyer-title {
      font-size: 13px;
      color: var(--muted);
    }

    .lawyer-cta {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-top: 4px;
    }

    .lawyer-cta-link {
      font-size: 12px;
      font-weight: 600;
      color: var(--primary);
      text-decoration: none;
    }

    .lawyer-cta-link:hover {
      text-decoration: underline;
    }

    .lawyer-city {
      font-size: 12px;
      color: #4b5563;
      font-weight: 600;
    }

    .lawyer-actions {
      display: flex;
      justify-content: flex-end;
    }

    .lawyer-link {
      border-radius: 999px;
      padding: 6px 12px;
      border: 1px solid #dbe4f5;
      background: #f8fbff;
      color: #2b4a8f;
      font-size: 12px;
      font-weight: 600;
    }

    .lawyer-note {
      font-size: 13px;
      color: var(--muted);
    }

    .lawyer-feedback {
      margin: 0;
      font-size: 13px;
      color: var(--muted);
      line-height: 1.5;
    }

    .lawyer-phone {
      font-size: 13px;
      font-weight: 600;
      color: #1f3f7a;
    }

    .lawyer-phone a {
      color: inherit;
      text-decoration: underline;
      text-underline-offset: 3px;
    }

    .lawyer-phone a:hover {
      color: var(--primary-dark);
    }

    .lawyer-reference-note {
      margin: 0;
      font-size: 12px;
      color: var(--muted);
    }

    .result-cta {
      display: none;
      gap: 8px;
      padding: 20px;
      border-radius: 18px;
      border: 1px solid #dbe7ff;
      background: linear-gradient(135deg, #ffffff 0%, #eef4ff 100%);
      box-shadow: 0 12px 28px rgba(15, 23, 42, 0.08);
    }

    .result-cta-note {
      margin: 0;
      font-size: 13px;
      color: var(--muted);
    }

    #app[data-result-mode="true"] .result-cta {
      display: grid;
    }

    #app[data-result-mode="true"] .reference-pre,
    #app[data-result-mode="true"] .reference-pre-note {
      display: none;
    }

    section.result-cta-secondary {
      display: none;
    }

    #app[data-result-mode="true"] section.result-cta-secondary {
      display: grid;
    }

    #app[data-result-mode="false"] .reference-result,
    #app[data-result-mode="false"] .reference-result-note,
    #app[data-result-mode="false"] .lawyer-phone,
    #app[data-result-mode="false"] .lawyer-cta-link,
    #app[data-result-mode="false"] .lawyer-cta {
      display: none;
    }

    #app[data-result-mode="false"] .result-cta {
      display: none;
    }

    #app .lawyers-block {
      display: none;
    }

    .tracking-cta-card {
      display: grid;
      gap: 14px;
      padding: 20px;
      border-radius: 18px;
      border: 1px solid #dbe7ff;
      background: linear-gradient(135deg, #ffffff 0%, #f2f6ff 100%);
      box-shadow: 0 12px 28px rgba(15, 23, 42, 0.08);
    }

    .tracking-cta-card.is-secondary {
      border-style: dashed;
      border-color: #c7d2e7;
      background: #f4f6f8;
      box-shadow: none;
    }

    .tracking-cta-card .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .tracking-cta-card .pill {
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(25, 90, 167, 0.12);
      color: #1f3f7a;
      font-weight: 600;
    }

    .tracking-cta-card .status-tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      font-weight: 600;
      color: var(--success);
    }

    .tracking-cta-card .soft-primary {
      width: 100%;
      background: rgba(25, 90, 167, 0.12);
      color: #1f3f7a;
      border: 1px solid rgba(25, 90, 167, 0.2);
    }

    .tracking-cta-card .soft-primary:hover {
      background: rgba(25, 90, 167, 0.2);
    }

    .form-error {
      color: #b91c1c;
      font-size: 12px;
      margin-top: 6px;
    }

    .time-pref-group {
      display: grid;
      gap: 8px;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    }

    .time-pref-button {
      width: 100%;
      border-radius: 999px;
      padding: 10px 12px;
      font-weight: 600;
      border: 1px solid #c7d2e7;
      background: transparent;
      color: #1f3f7a;
    }

    .time-pref-button.is-active {
      background: var(--primary);
      border-color: var(--primary);
      color: #fff;
      box-shadow: 0 10px 20px rgba(25, 90, 167, 0.2);
    }

    .modal-bottom {
      width: min(520px, 92vw);
    }

    @media (max-width: 720px) {
      .modal-bottom {
        align-self: flex-end;
        width: 100%;
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
        max-height: 90vh;
        overflow-y: auto;
      }
    }

    .references-modal[data-result-mode="true"] .reference-pre,
    .references-modal[data-result-mode="true"] .reference-pre-note {
      display: none;
    }

    .references-modal[data-result-mode="false"] .reference-result,
    .references-modal[data-result-mode="false"] .reference-result-note,
    .references-modal[data-result-mode="false"] .lawyer-phone,
    .references-modal[data-result-mode="false"] .lawyer-cta-link,
    .references-modal[data-result-mode="false"] .lawyer-cta {
      display: none;
    }

    .reference-cta {
      display: grid;
      gap: 10px;
      padding: 16px;
      border-radius: 16px;
      border: 1px solid #dbe7ff;
      background: linear-gradient(135deg, #ffffff 0%, #f3f7ff 100%);
    }

    .reference-cta h3 {
      margin: 0;
      font-size: 16px;
    }

    .reference-cta p {
      margin: 0;
      color: var(--muted);
      font-size: 14px;
    }

    .reference-cta-actions {
      display: grid;
      gap: 10px;
    }

    .reference-cta-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 999px;
      padding: 10px 16px;
      background: var(--primary);
      color: #fff;
      font-weight: 600;
      text-decoration: none;
      box-shadow: 0 12px 20px rgba(25, 90, 167, 0.18);
      transition: background 0.2s ease;
    }

    .reference-cta-button:hover {
      background: var(--primary-dark);
    }

    .secondary-button {
      border-radius: 999px;
      padding: 8px 14px;
      border: 1px solid #c7d2e7;
      background: transparent;
      color: #1f3f7a;
      font-weight: 600;
      font-size: 13px;
    }

    .secondary-button:hover {
      background: #f2f6ff;
    }

    .automation-block {
      display: grid;
      gap: 16px;
      padding: 22px;
      border-radius: 20px;
      border: 1px solid #dbe7ff;
      background: linear-gradient(135deg, #ffffff 0%, #f5f9ff 100%);
      box-shadow: 0 16px 32px rgba(15, 23, 42, 0.08);
    }

    .automation-grid {
      display: grid;
      gap: 16px;
    }

    .automation-card {
      display: grid;
      gap: 8px;
      padding: 16px;
      border-radius: 16px;
      border: 1px solid #e2e8f0;
      background: #ffffff;
      box-shadow: 0 10px 22px rgba(15, 23, 42, 0.06);
    }

    .automation-card strong {
      font-size: 15px;
    }

    .automation-icon {
      width: 36px;
      height: 36px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      background: rgba(25, 90, 167, 0.12);
      color: var(--primary);
    }

    .founders-block {
      display: grid;
      gap: 14px;
    }

    .founders-grid {
      display: grid;
      gap: 14px;
    }

    .founder-card {
      display: grid;
      gap: 10px;
      padding: 16px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: #ffffff;
      box-shadow: 0 10px 22px rgba(15, 23, 42, 0.06);
    }

    .founder-header {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .founder-avatar {
      width: 52px;
      height: 52px;
      border-radius: 16px;
      background: linear-gradient(135deg, #e6f0ff, #f9fbff);
      display: grid;
      place-items: center;
      font-weight: 700;
      color: #2e4aa1;
    }

    .founder-photo {
      width: 72px;
      height: 72px;
      border-radius: 18px;
      object-fit: cover;
      border: 1px solid #dbe4f5;
      background: #f8fafc;
    }

    .founder-details {
      display: grid;
      gap: 6px;
    }

    .founder-name {
      font-weight: 700;
    }

    .founder-role {
      font-size: 13px;
      color: var(--muted);
      font-weight: 600;
    }

    .founder-links {
      display: grid;
      gap: 6px;
      font-size: 13px;
      color: var(--muted);
    }

    .founder-links a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 600;
    }

    .founder-links a:hover {
      text-decoration: underline;
    }

    .founder-photo-only {
      display: grid;
      place-items: center;
      padding: 20px;
    }

    .modal-form {
      display: grid;
      gap: 12px;
    }

    .modal-form input {
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid #d6deea;
      font-size: 14px;
      font-family: inherit;
    }

    .modal-actions {
      display: flex;
      justify-content: flex-end;
    }

    .cta-block {
      display: grid;
      gap: 10px;
      padding: 20px;
      border-radius: 18px;
      border: 1px solid #dbeafe;
      background: #f7faff;
    }

    .cta-button {
      width: 100%;
      padding: 16px 20px;
      font-size: 16px;
      border-radius: 14px;
    }

    .cta-meta {
      font-size: 13px;
      color: var(--muted);
    }

    .cta-legal {
      font-size: 11px;
      color: var(--muted);
      line-height: 1.4;
    }

    .cta-legal a {
      color: inherit;
      text-decoration: underline;
    }

    .cta-warning {
      font-size: 12px;
      color: var(--muted);
      background: transparent;
      border-radius: 0;
      padding: 0;
      border: none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .catch-cta {
      display: grid;
      gap: 12px;
      border-radius: 18px;
      background: linear-gradient(135deg, #ffffff 0%, #f3f7ff 100%);
      border: 1px solid #dbe7ff;
      padding: 20px;
    }

    .catch-cta p {
      margin: 0;
    }

    .outline-button {
      border: 1px solid #c7d2e7;
      background: transparent;
      color: #1f3f7a;
    }

    .outline-button:hover {
      background: #f2f6ff;
    }

    .catch-cta .outline-button {
      width: 100%;
      border-radius: 12px;
      padding: 14px 18px;
    }

    @media (min-width: 720px) {
      #app {
        padding: 40px;
        max-width: 1100px;
        margin: 0 auto;
      }

      .layout {
        display: flex;
        flex-direction: column;
        gap: 20px;
        align-items: center;
      }

      #stageOne,
      #stageTwo {
        width: 100%;
        max-width: 780px;
        margin: 0 auto;
      }

      .app-bar {
        display: none;
      }

      .hero-card {
        padding: 20px;
      }

      .hero-title {
        font-size: 22px;
      }

      #processCard {
        max-width: 780px;
        margin: 0 auto;
      }

      .reference-cta-actions {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .card:hover {
        transform: none;
        box-shadow: 0 12px 30px rgba(15, 23, 42, 0.1);
      }
    }

    @media (min-width: 960px) {
      .stage-one {
        display: grid;
        grid-template-columns: 1fr 1fr;
        align-items: start;
      }

      .stage-one > :nth-child(1) {
        grid-column: 1;
      }

      .stage-one > :nth-child(3) {
        grid-column: 2;
      }

      .trust-bar {
        grid-column: 1 / -1;
      }

      .steps-block,
      .trust-infra-block,
      .automation-block,
      .lawyers-block,
      .founders-block,
      .info-block {
        grid-column: 1 / -1;
      }

      .card-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .card-grid .card:last-child {
        grid-column: span 2;
      }

      .automation-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .founders-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .catch-cta {
        grid-template-columns: 1fr auto;
        align-items: center;
      }

      .catch-cta .outline-button {
        width: auto;
        min-width: 220px;
      }
    }

    @media (max-width: 720px) {
      .process-details-list {
        max-height: 200px;
      }

      .trust-logos {
        grid-template-columns: none;
        grid-auto-flow: column;
        grid-auto-columns: minmax(140px, 1fr);
        overflow-x: auto;
        padding-bottom: 6px;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <section class="layout">
      <div class="card stack" id="stageOne">
        <div class="stage-one">
          <section class="cta-block" id="primaryCta">
            <div class="required-docs" id="requiredDocs">
              <div class="required-docs-summary">
                <strong>Gereken evraklar:</strong> Eksper/Hasar raporu
                <span class="required-docs-meta">
                  Süre: ~1–2 dk • Hesaplama sonrası belgeler otomatik silinir.
                </span>
              </div>
              <a
                class="required-docs-link"
                href="https://www.turkiye.gov.tr/sbvgm-trafik-ve-kasko-eksper-raporlari-sorgulama"
                target="_blank"
                rel="noopener"
              >
                <img
                  class="required-docs-logo"
                  src="https://e7.pngegg.com/pngimages/453/86/png-clipart-drop-off-e-government-android-turkey-android-rectangle-logo.png"
                  alt="e-Devlet"
                  loading="lazy"
                />
                e-Devlet’ten Eksper Raporu indir
                <svg class="required-docs-external" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path
                    d="M14 5h5v5m0-5-9 9m-5-4v9h9"
                    stroke="currentColor"
                    stroke-width="1.6"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </a>
            </div>
            <button type="button" id="calculateButton" class="cta-button" disabled>Değer Kaybımı Hesapla</button>
          </section>

          <div class="trust-bar">
            <div class="trust-bar-items">
              <span class="trust-item">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M7 11V8a5 5 0 0 1 10 0v3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  <rect x="5" y="11" width="14" height="10" rx="2" stroke="currentColor" stroke-width="2"/>
                </svg>
                Belgeleriniz şifreli işlenir.
              </span>
              <span class="trust-item">
                <span class="trust-dot" aria-hidden="true"></span>
                Hesaplama tamamlandığında belgeleriniz otomatik silinir.
              </span>
            </div>
            <a class="trust-link" href="#" id="trustDetailsLink">Detaylar</a>
          </div>

          <section class="hero-block">
            <h1 class="hero-title-lg">Ücretsiz Danışmanlık Talebi</h1>
            <p class="hero-subtitle">
              İhtarınızı sistemimizle ücretsiz oluşturduktan sonra, isterseniz Dosyam360 güvenli altyapısını tercih eden bir
              firmadan ücretsiz danışmanlık talep edebilirsiniz.
            </p>
            <div class="hero-cta-group">
              <button type="button" class="primary hero-cta" data-tracking-cta-button="true">Ücretsiz Danışmanlık Talep Et</button>
              <span class="hero-cta-note">
                İster vekalet ve ücret talep etmeyen kullanıcılarımız ile ister direkt bir vekil atama seçeneğiniz vardır.
              </span>
            </div>
            <div class="pill-row" aria-label="Hizmet vurguları">
              <span class="pill">Opsiyonel hizmet</span>
              <span class="pill">Ücretsiz görüşme</span>
              <span class="pill">Şeffaf iletişim</span>
            </div>
          </section>

          <section class="trust-infra-block">
            <div>
              <h2>Güven ve Altyapı</h2>
              <p class="hero-subtitle">Kurumsal, şeffaf ve otomatik bir altyapı ile süreci uçtan uca görünür kılar.</p>
            </div>
            <ul class="trust-infra-list">
              <li class="trust-infra-item">
                <span class="trust-infra-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M7 11V8a5 5 0 0 1 10 0v3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <rect x="5" y="11" width="14" height="10" rx="2" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </span>
                <span>
                  Belgeler uçtan uca şifrelenir ve işlem sonrası otomatik silinir.
                  <span class="trust-subline"><strong>ISO 27001</strong> uyumlu veri işleme ve <strong>SSL</strong> güvenlik standardı</span>
                </span>
              </li>
              <li class="trust-infra-item">
                <span class="trust-infra-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M12 3l7 3v6c0 5-3.5 8-7 9-3.5-1-7-4-7-9V6l7-3z" stroke="currentColor" stroke-width="2"/>
                    <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </span>
                <span>Yapay zekâ destekli otomasyon altyapısı</span>
              </li>
              <li class="trust-infra-item">
                <span class="trust-infra-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M4 6h16v10H4z" stroke="currentColor" stroke-width="2"/>
                    <path d="M7 20h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M8 10h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </span>
                <span>Şeffaf ekran üzerinden süreç takibi</span>
              </li>
              <li class="trust-infra-item">
                <span class="trust-infra-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M6 4h12v16H6z" stroke="currentColor" stroke-width="2"/>
                    <path d="M9 8h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M9 12h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M9 16h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </span>
                <span>Her önemli aşamada otomatik SMS bilgilendirme sistemi</span>
              </li>
            </ul>
            <div>
              <p class="hero-subtitle">Kurumsal altyapı partnerleri</p>
              <div class="trust-logos" aria-label="Kurumsal altyapı partnerleri logoları">
                <div class="trust-logo-card">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/4/4d/OpenAI_Logo.svg" alt="OpenAI" loading="lazy" />
                </div>
                <div class="trust-logo-card">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/9/93/Amazon_Web_Services_Logo.svg" alt="AWS" loading="lazy" />
                </div>
                <div class="trust-logo-card">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg" alt="Google" loading="lazy" />
                </div>
              </div>
            </div>
            <details class="trust-docs" open>
              <summary>Kurumsal kimlik bilgileri</summary>
              <div class="trust-doc-card">
                <div class="trust-doc-line"><strong>Vergi Dairesi:</strong> Göztepe</div>
                <div class="trust-doc-line">
                  <strong>Şirket Adresi:</strong><br />
                  EĞİTİM MAH. MURATPAŞA CAD.<br />
                  KENT PLUS SİTESİ C BLOK NO: 17<br />
                  İÇ KAPI NO: 67<br />
                  KADIKÖY / İSTANBUL
                </div>
                <div class="trust-doc-line"><strong>Sabit Hat Telefon:</strong> —</div>
              </div>
            </details>
          </section>

          <section class="steps-block">
            <h2>Nasıl İlerler?</h2>
            <div class="steps-grid">
              <div class="step-card">
                <span class="step-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M4 7h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <rect x="4" y="7" width="16" height="12" rx="2" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </span>
                <div>
                  <strong>Evrakları yükleyin</strong>
                  <p>Belgeler net ve eksiksiz olmalı.</p>
                </div>
              </div>
              <div class="step-card">
                <span class="step-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M5 12l4 4L19 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </span>
                <div>
                  <strong>Okunabilirlik kontrolü</strong>
                  <p>Uygunluk ve netlik otomatik doğrulanır.</p>
                </div>
              </div>
              <div class="step-card">
                <span class="step-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M12 6v12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M6 12h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </span>
                <div>
                  <strong>Hesaplamayı başlatın</strong>
                  <p>Tek tıkla tutar oluşturulur.</p>
                </div>
              </div>
            </div>
          </section>

          <section class="automation-block">
            <div>
              <h2>GAIA Otomasyonu ile Tam Şeffaf Takip</h2>
              <p class="hero-subtitle">
                Tahkim dosyalarında her adım kayıtlıdır. Müvekkil ve ofisler için otomatik bilgilendirme ve takip
                kolaylığı sunar.
              </p>
            </div>
            <div class="automation-grid">
              <article class="automation-card">
                <div class="automation-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M4 6h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <rect x="4" y="6" width="16" height="12" rx="2" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </div>
                <strong>Tahkim dosyalarında tam şeffaflık</strong>
                <p>Süreç, belgeler ve adımlar tek ekranda izlenir.</p>
              </article>
              <article class="automation-card">
                <div class="automation-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M7 4h10v16H7z" stroke="currentColor" stroke-width="2"/>
                    <path d="M9 8h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </div>
                <strong>Müvekkil dosya takip ekranı</strong>
                <p>Müvekkiller her aşamayı kendi panelinden görür.</p>
              </article>
              <article class="automation-card">
                <div class="automation-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M6 12h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M12 6v12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </div>
                <strong>SMS ile anlık bilgilendirme</strong>
                <p>Her kritik adımda otomatik SMS gider.</p>
              </article>
              <article class="automation-card">
                <div class="automation-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M4 8h16v10H4z" stroke="currentColor" stroke-width="2"/>
                    <path d="M4 8l8 6 8-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </div>
                <strong>Avukatlık ofislerine e-posta güncellemeleri</strong>
                <p>Sürekli manuel takip ihtiyacını azaltır.</p>
              </article>
              <article class="automation-card">
                <div class="automation-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M4 12h8l2 3 4-6 2 3h2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </div>
                <strong>Yapay zekâ ile daha hızlı takip</strong>
                <p>Özetler, uyarılar ve aksiyon önerileri üretir.</p>
              </article>
              <article class="automation-card">
                <div class="automation-icon" aria-hidden="true">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M7 7h10v10H7z" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 3v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </div>
                <strong>Ödeme/harç/bilirkişi uyarı sistemi</strong>
                <p>Dosyayı aksatabilecek gecikmeleri önceden bildirir.</p>
              </article>
            </div>
          </section>

          <div id="lawyersBlockHome"></div>
          <section class="lawyers-block" id="referencesSection">
            <div>
              <h2>
                <span class="reference-pre">Otomasyonumuzu Kullanan Ekipler</span>
                <span class="reference-result">Dosyanıza Şeffaf Takip başlatın</span>
              </h2>
              <p class="hero-subtitle reference-pre">
                Trafik/sigorta dosyalarında GAIA ile süreçleri daha şeffaf ve hızlı yöneten danışmanlık ekiplerinden kısa
                geri bildirimler.
              </p>
              <p class="hero-subtitle reference-result">
                Bu noktadan sonrası resmi yazışmalar, harçlar ve raporlarla ilerler. GAIA otomasyonunu kullanan danışmanlık
                ekipleri dosyanızı şeffaf şekilde takip edebilir.
              </p>
            </div>
            <div class="lawyers-grid">
              <article class="lawyer-card">
                <div class="lawyer-header">
                  <div class="lawyer-meta">
                    <div class="lawyer-name">Atlas Hasar</div>
                    <div class="lawyer-title">Hasar Danışmanlık Ekibi</div>
                  </div>
                  <span class="lawyer-tag">Referans</span>
                </div>
                <p class="lawyer-feedback">
                  “GAIA ile dosyalarımız daha şeffaf ve hızlı ilerliyor.”
                </p>
                <div class="lawyer-cta">
                  <div class="lawyer-phone">Telefon: <a href="tel:05316164585">0531 616 45 85</a></div>
                  <a class="lawyer-cta-link" href="tel:05316164585">Bilgi al</a>
                </div>
              </article>
              <article class="lawyer-card">
                <div class="lawyer-header">
                  <div class="lawyer-meta">
                    <div class="lawyer-name">Pusula Hasar</div>
                    <div class="lawyer-title">Hasar Danışmanlık Ekibi</div>
                  </div>
                  <span class="lawyer-tag">Referans</span>
                </div>
                <p class="lawyer-feedback">
                  “SMS bilgilendirmeler sayesinde müvekkiller daha rahat ediyor.”
                </p>
                <div class="lawyer-cta">
                  <div class="lawyer-phone">Telefon: <a href="tel:05441650781">0544 165 07 81</a></div>
                  <a class="lawyer-cta-link" href="tel:05441650781">Bilgi al</a>
                </div>
              </article>
            </div>
            <p class="lawyer-reference-note reference-pre-note">
              Referanslar, danışmanlık ekiplerinin paylaştığı müşteri deneyimlerinden derlenmiştir.
            </p>
            <p class="lawyer-reference-note reference-result-note">
              Bilgi almak için arayın; ekipler sürecinizi şeffaflık içinde yönetsin.
            </p>
          </section>

          <section class="founders-block">
            <div>
              <h2>Biz Kimiz?</h2>
              <p class="hero-subtitle">Sigorta hukuku süreçlerini otomasyonla sadeleştiriyoruz.</p>
            </div>
            <div class="founders-grid">
              <article class="founder-card">
                <div class="founder-header">
                  <img
                    class="founder-photo"
                    src="https://media.licdn.com/dms/image/v2/D4D03AQHglv8dSDhzNA/profile-displayphoto-shrink_200_200/B4DZWCznHZGcAY-/0/1741656322902?e=2147483647&v=beta&t=Vc6xk5EdkJPz3nZaS9Hv3Q7oI0VHjIs74swwThCv-h0"
                    alt="Saltuk Kıraç"
                  />
                  <div class="founder-details">
                    <div class="founder-name">Saltuk Kıraç</div>
                    <div class="founder-role">GAIA Kurucusu</div>
                    <div class="founder-links">
                      <span>Email: <a href="mailto:saltukkirac@gmail.com">saltukkirac@gmail.com</a></span>
                      <span>Reddit: u/saltukkirac ve u/saltukirac</span>
                      <span>LinkedIn: <a href="https://www.linkedin.com/in/saltuk-kirac/" target="_blank" rel="noopener">linkedin.com/in/saltuk-kirac</a></span>
                    </div>
                  </div>
                </div>
              </article>
              <article class="founder-card">
                <div class="founder-header">
                  <img
                    class="founder-photo"
                    src="https://3eb5781fa49387b730714ea4e6de8465.cdn.bubble.io/f1769549742377x911112995364904200/WhatsApp%20Image%202026-01-28%20at%2000.35.21.jpeg?_gl=1*ufjsjf*_gcl_au*NjcyMjkyMTM4LjE3NjU3MjIyMTI.*_ga*MTUxNDExNjAyNS4xNzQyMzI4OTA1*_ga_BFPVR2DEE2*czE3Njk2MDA2MzQkbzIxMyRnMCR0MTc2OTYwMDYzNCRqNjAkbDAkaDA."
                    alt="Mevlüt Kıraç"
                  />
                  <div class="founder-details">
                    <div class="founder-name">Mevlüt Kıraç</div>
                    <div class="founder-role">Dosyam360 Kurucusu</div>
                    <div class="founder-links">
                      <span>Email: <a href="mailto:mevlutkirac@gmail.com">mevlutkirac@gmail.com</a></span>
                    </div>
                  </div>
                </div>
              </article>
            </div>
          </section>
          <article class="tracking-cta-card is-secondary is-hidden" id="trackingCtaCardBottom" aria-hidden="true">
            <button
              type="button"
              class="outline-button soft-primary"
              data-tracking-cta-button="true"
            >
              Ücretsiz Danışmanlık Talep Et
            </button>
            <small class="cta-meta">
              İster vekalet ve ücret talep etmeyen kullanıcılarımız ile ister direkt bir vekil atama seçeneğiniz vardır.
            </small>
            <span class="status-tag is-hidden" data-tracking-cta-status="true">Danışmanlık talebi alındı ✓</span>
            <div>
              <h3>Ücretsiz Danışmanlık Talebi</h3>
              <p>
                İhtarınızı sistemimizle ücretsiz oluşturduktan sonra, isterseniz Dosyam360 güvenli altyapısını tercih eden bir
                firmadan ücretsiz danışmanlık talep edebilirsiniz.
              </p>
            </div>
            <div class="pill-row">
              <span class="pill">Opsiyonel hizmet</span>
              <span class="pill">Ücretsiz görüşme</span>
              <span class="pill">Şeffaf iletişim</span>
            </div>
            <small class="cta-meta">Talep bırakmanız zorunlu değildir; yalnızca isterseniz paylaşabilirsiniz.</small>
          </article>

          <section class="info-block">
            <h2>Şeffaf Takip Sistemleri Neden Gerekli?</h2>
            <p class="hero-subtitle">
              Süreç içindeki her adımı tek ekranda görmek, hukuki işlerde belirsizliği azaltır ve kontrol hissini güçlendirir.
            </p>
            <div class="info-grid">
              <div class="info-item">
                <h3>Merkezi süreç ekranı</h3>
                <p>Evraklar, mailleşmeler, onaylanan tutarlar ve ödemeler tek panelde görünür.</p>
              </div>
              <div class="info-item">
                <h3>Otomatik bildirim akışı</h3>
                <p>Önemli aşamalarda SMS ve panel bildirimleriyle bilgilendirme sağlanır.</p>
              </div>
              <div class="info-item">
                <h3>Kontrollü ve izlenebilir yapı</h3>
                <p>Sistem, müvekkil ve uzman arasındaki iletişimi düzenler ve her adımı izlenebilir kılar.</p>
              </div>
            </div>
          </section>

        </div>
      </div>
      <main class="main-panel" id="stageTwo" data-ui-state="empty">
        <div class="toast toast-error state-error">
          Bazı belgeler okunamıyor. Lütfen sol panelden kontrol edin.
        </div>
        <div class="toast toast-success state-success">
          Hesaplama tamamlandı. Dilekçeniz hazır.
        </div>

        <div class="app-bar" aria-label="Uygulama üst barı">
          <div class="app-bar-brand">
            <div>
              <div>Değer Kaybı</div>
              <div class="app-bar-title">Hızlı Hesaplama</div>
            </div>
          </div>
          <span class="secure-note">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M7 11V8a5 5 0 0 1 10 0v3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <rect x="5" y="11" width="14" height="10" rx="2" stroke="currentColor" stroke-width="2"/>
            </svg>
            Güvenli başvuru
          </span>
        </div>

        <section class="summary-card" id="summaryCard" aria-live="polite">
          <div class="summary-header">
            <div>
              <span class="badge">Sonuç Özeti</span>
              <h2 class="hero-title">Hesaplama ve İhtar Bilgisi</h2>
              <p class="summary-meta" id="summaryStatus">
                Henüz hesaplama yapılmadı. Evraklar yüklendiyse hesaplamayı başlatabilirsiniz.
              </p>
            </div>
            <div class="summary-amount" id="summaryAmount">₺--</div>
          </div>
          <div class="summary-actions">
            <button type="button" class="primary" id="summaryCalculateButton">Hesapla</button>
            <a class="outline-button is-hidden" id="summaryDownload" href="#" target="_blank" rel="noopener">
              İhtar Dilekçesini İndir
            </a>
          </div>
          <p class="summary-security-note" id="summarySecurityNote">
            Belgeleriniz yalnızca bu başvuru için kullanılır ve 256-bit şifreleme ile korunur.
            <strong>İşleminiz bittikten sonra belgeleriniz otomatik olarak silinir.</strong>
          </p>
          <div class="summary-meta" id="summaryDate">Hesaplama tarihi: --</div>
        </section>

        <section class="card-grid">
          <article class="card process-card is-hidden" id="processCard" aria-hidden="true" tabindex="-1">
            <div class="process-header">
              <h2 class="status-title">Süreç Takibi</h2>
              <span class="process-tag" id="processTag">Belgeler bekleniyor</span>
            </div>
            <div class="process-stepper" id="processStepper" aria-label="Süreç adımları">
              <div class="process-step pending" data-step="1">
                <span class="process-circle">1</span>
                <span class="process-label">Belgeler alındı</span>
              </div>
              <div class="process-step pending" data-step="2">
                <span class="process-circle">2</span>
                <span class="process-label">Bilgiler çıkarılıyor</span>
              </div>
              <div class="process-step pending" data-step="3">
                <span class="process-circle">3</span>
                <span class="process-label">Değer kaybı tahmini</span>
              </div>
              <div class="process-step pending" data-step="4">
                <span class="process-circle">4</span>
                <span class="process-label">İhtar dilekçesi</span>
              </div>
            </div>
            <div class="process-body">
              <h3 class="process-title" id="processTitle">Belgeler bekleniyor</h3>
              <p class="process-subtitle" id="processSubtitle">
                Süreç başladığında adım adım bilgilendirileceksiniz.
              </p>
              <div class="process-mini is-hidden" id="processMini"></div>
              <a class="process-cta is-hidden" id="processCta" href="#" target="_blank" rel="noopener">İhtar Dilekçesini İndir</a>
              <div class="process-note is-hidden" id="processNote"></div>
            </div>
          </article>
          <article class="tracking-cta-card is-secondary is-hidden" id="trackingCtaCard" aria-hidden="true">
            <button
              type="button"
              class="outline-button soft-primary"
              data-tracking-cta-button="true"
            >
              Ücretsiz Danışmanlık Talep Et
            </button>
            <small class="cta-meta">
              İster vekalet ve ücret talep etmeyen kullanıcılarımız ile ister direkt bir vekil atama seçeneğiniz vardır.
            </small>
            <span class="status-tag is-hidden" data-tracking-cta-status="true">Danışmanlık talebi alındı ✓</span>
            <div>
              <h3>Ücretsiz Danışmanlık Talebi</h3>
              <p>
                İhtarınızı sistemimizle ücretsiz oluşturduktan sonra, isterseniz Dosyam360 güvenli altyapısını tercih eden bir
                firmadan ücretsiz danışmanlık talep edebilirsiniz.
              </p>
            </div>
            <div class="pill-row">
              <span class="pill">Opsiyonel hizmet</span>
              <span class="pill">Ücretsiz görüşme</span>
              <span class="pill">Şeffaf iletişim</span>
            </div>
            <small class="cta-meta">Talep bırakmanız zorunlu değildir; yalnızca isterseniz paylaşabilirsiniz.</small>
          </article>
          <div id="referencesSlot"></div>

        </section>

        <header class="hero-card">
          <div class="hero-top">
            <div>
              <span class="badge">Güvenli Başvuru</span>
              <h1 class="hero-title">Hukuki sürecinizi şeffaf bir şekilde takip edin.</h1>
              <p>
                Evrakını yükle, değer kaybını öğren, başvuru dilekçeni hazırla. Hepsi ücretsiz, hızlı ve otomatik.
              </p>
            </div>
            <div class="hero-actions">
              <a class="hero-actions-link" href="#" id="howItWorksLink">Nasıl Çalışır?</a>
              <div>
                <span class="secure-note">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M7 11V8a5 5 0 0 1 10 0v3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <rect x="5" y="11" width="14" height="10" rx="2" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Verileriniz güvenle işlenir
                </span>
                <span class="secure-meta">256-bit şifreleme ile korunur.</span>
              </div>
            </div>
          </div>
        </header>

      </main>
    </section>
  </div>

  <div class="modal-backdrop" id="trustDetailsModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="trustDetailsTitle">
      <div class="modal-header">
        <h3 id="trustDetailsTitle">Detaylar</h3>
        <button class="modal-close" type="button" id="closeTrustModalButton">Kapat</button>
      </div>
      <ul class="list">
        <li>Belgeler sadece hesaplama ve dilekçe üretimi için kullanılır.</li>
        <li>Hesaplama tamamlandığında belgeleriniz otomatik silinir.</li>
        <li>Paylaşım yapılmaz, üçüncü taraf erişimi yoktur.</li>
        <li>Yasal saklama zorunluluğu olmadıkça sistemde tutulmaz.</li>
        <li>Silme süreci otomatik çalışır, manuel işlem gerekmez.</li>
      </ul>
    </div>
  </div>

  <div class="modal-backdrop" id="howItWorksModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="howItWorksTitle">
      <div class="modal-header">
        <h3 id="howItWorksTitle">Nasıl Çalışır?</h3>
        <button class="modal-close" type="button" id="closeModalButton">Kapat</button>
      </div>
      <div class="steps">
        <div class="step">
          <span>1</span>
          <div>
            <strong>Belgeler doğrulanır.</strong>
            <p>Yüklediğiniz evraklar okunabilirlik ve doğruluk açısından kontrol edilir.</p>
          </div>
        </div>
        <div class="step">
          <span>2</span>
          <div>
            <strong>Değer kaybı hesaplanır.</strong>
            <p>Belgelerinizden alınan bilgilerle tahmini tutar hızlıca oluşturulur.</p>
          </div>
        </div>
        <div class="step">
          <span>3</span>
          <div>
            <strong>Dilekçe hazırlanır.</strong>
            <p>Hesaplama sonucuna göre başvuru metni otomatik olarak hazırlanır.</p>
          </div>
        </div>
        <div class="step">
          <span>4</span>
          <div>
            <strong>Opsiyonel danışmanlık desteği.</strong>
            <p>
              İhtarı oluşturduktan sonra dilerseniz dosyanızı şeffaf altyapımızı kullanan bir danışmana, vekaletsiz ve
              komisyonsuz olarak ücretsiz danışmanlık için bırakabilirsiniz.
            </p>
          </div>
        </div>
        <div class="step">
          <span>5</span>
          <div>
            <strong>Dava süreci takibi.</strong>
            <p>
              Dava süreci başlatılma kararı alınırsa, sistemden anlık takip edebilir ve SMS bilgilendirmelerden
              faydalanabilirsiniz.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal-backdrop" id="referencesModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="referencesTitle">
      <div class="modal-header">
        <h3 id="referencesTitle">Referanslarımız</h3>
        <button class="modal-close" type="button" id="closeReferencesModalButton">Kapat</button>
      </div>
      <div id="referencesModalBody" class="references-modal" data-result-mode="false"></div>
    </div>
  </div>

  <div class="modal-backdrop" id="trackingModal" aria-hidden="true">
      <div class="modal modal-bottom" role="dialog" aria-modal="true" aria-labelledby="trackingModalTitle">
        <div class="modal-header">
        <h3 id="trackingModalTitle">Ücretsiz danışmanlık talebi</h3>
        <button class="modal-close" type="button" id="closeTrackingModalButton">Kapat</button>
      </div>
      <div class="stack" id="trackingModalBody">
        <p>
          İhtarınızı sistemimizle ücretsiz oluşturduktan sonra, isterseniz Dosyam360 güvenli altyapısını tercih eden bir firmadan
          ücretsiz danışmanlık talep edebilirsiniz.
        </p>
        <label class="stack">
          <span>Telefon numaranız</span>
          <input type="tel" id="trackingPhone" placeholder="05xx xxx xx xx" />
          <span class="form-error is-hidden" id="trackingPhoneError">Telefon numarası zorunlu.</span>
        </label>
        <small class="cta-legal">İletişim bilgileriniz yalnızca bu başvuru ve süreç başlatma amacıyla kullanılır.</small>
        <div class="modal-actions">
          <button type="button" class="outline-button" id="trackingCancelButton">Vazgeç</button>
          <button type="button" class="primary" id="trackingSubmitButton">Ücretsiz Danışmanlık Talep Et</button>
        </div>
        <small class="cta-meta">İster vekalet ve ücret talep etmeyen kullanıcılarımız ile ister direkt bir vekil atama seçeneğiniz vardır.</small>
        <div class="toast toast-error state-error is-hidden" id="trackingModalError">
          Talep kaydedilemedi. Lütfen tekrar deneyin.
        </div>
      </div>
      <div class="stack is-hidden" id="trackingModalSuccess">
        <h3>Talebiniz alındı</h3>
        <p>Talebiniz ilgili ekibe iletildi. Dilerseniz süreç hakkında bilgi verilecektir.</p>
        <button type="button" class="primary" id="trackingSuccessClose">Tamam</button>
      </div>
    </div>
  </div>

  <script>
    (function () {
      function readInlineResultJson() {
        const inlineScript = document.getElementById("resultDataJson");
        let inlineScriptValue = "";
        if (inlineScript) {
          inlineScriptValue = inlineScript.textContent || "";
          if (!inlineScriptValue && "value" in inlineScript) {
            inlineScriptValue = inlineScript.value || "";
          }
        }
        const inlineTextarea = document.getElementById("resultDataJsonTextarea");
        const inlineTextareaValue =
          inlineTextarea && "value" in inlineTextarea ? inlineTextarea.value || "" : "";
        const dataElement = document.querySelector("[data-result-json]");
        const dataAttributeValue = dataElement
          ? (dataElement.getAttribute("data-result-json") || dataElement.textContent || "")
          : "";
        const jsonScripts = Array.from(document.querySelectorAll("script[type='application/json']"));
        const jsonScriptCandidate = jsonScripts.find((script) => {
          const content = script.textContent || "";
          return content.trim() !== "";
        });
        const jsonScriptValue = jsonScriptCandidate ? jsonScriptCandidate.textContent || "" : "";
        let commentValue = "";
        try {
          const walker = document.createTreeWalker(document.documentElement, NodeFilter.SHOW_COMMENT);
          let node = walker.nextNode();
          while (node) {
            const content = node.nodeValue || "";
            if (content.includes("{") && content.includes("}")) {
              const start = content.indexOf("{");
              const end = content.lastIndexOf("}");
              if (start !== -1 && end !== -1 && end > start) {
                commentValue = content.slice(start, end + 1);
              } else {
                commentValue = content;
              }
              break;
            }
            node = walker.nextNode();
          }
        } catch (error) {
          console.warn("comment scan failed", error);
        }
        return (
          inlineScriptValue ||
          inlineTextareaValue ||
          dataAttributeValue ||
          jsonScriptValue ||
          commentValue ||
          ""
        );
      }

      function resolveResultJsonSource() {
        const windowValue = window.RESULT_DATA_JSON;
        const fallbackValue = window.RESULT_DATA;
        if (windowValue && typeof windowValue === "object") {
          return windowValue;
        }
        if (typeof windowValue === "string" && windowValue.trim() !== "") {
          return windowValue;
        }
        if (fallbackValue && typeof fallbackValue === "object") {
          return fallbackValue;
        }
        if (typeof fallbackValue === "string" && fallbackValue.trim() !== "") {
          return fallbackValue;
        }
        const inlineValue = readInlineResultJson();
        return inlineValue;
      }

      function normalizeEvrakFlag(value) {
        if (typeof value === "string") {
          const normalized = value.trim().toLowerCase();
          if (["true", "1", "evet", "yes"].includes(normalized)) {
            return true;
          }
          if (["false", "0", "hayir", "hayır", "no"].includes(normalized)) {
            return false;
          }
        }
        return Boolean(value);
      }

      window.EVRAKLAR_YUKLENDI = (window.EVRAKLAR_YUKLENDI === true);
      let evraklarYuklendi = (window.EVRAKLAR_YUKLENDI === true);
      const resultDataJson = resolveResultJsonSource();

      const appRoot = document.getElementById("app");
      const stageOne = document.getElementById("stageOne");
      const stageTwo = document.getElementById("stageTwo");
      const primaryCta = document.getElementById("primaryCta");
      const calculateButton = document.getElementById("calculateButton");
      const referencesSection = document.getElementById("referencesSection");
      const statusStateLabel = document.getElementById("statusStateLabel");
      const resultAmount = document.getElementById("resultAmount");
      const resultDate = document.getElementById("resultDate");
      const resultCard = document.getElementById("resultCard");
      const statusCard = document.getElementById("statusCard");
      const howItWorksLink = document.getElementById("howItWorksLink");
      const howItWorksModal = document.getElementById("howItWorksModal");
      const closeModalButton = document.getElementById("closeModalButton");
      const trustDetailsLink = document.getElementById("trustDetailsLink");
      const trustDetailsModal = document.getElementById("trustDetailsModal");
      const closeTrustModalButton = document.getElementById("closeTrustModalButton");
      const referencesModal = document.getElementById("referencesModal");
      const referencesModalBody = document.getElementById("referencesModalBody");
      const closeReferencesModalButton = document.getElementById("closeReferencesModalButton");
      const trackingModal = document.getElementById("trackingModal");
      const closeTrackingModalButton = document.getElementById("closeTrackingModalButton");
      const trackingModalBody = document.getElementById("trackingModalBody");
      const trackingModalSuccess = document.getElementById("trackingModalSuccess");
      const trackingSubmitButton = document.getElementById("trackingSubmitButton");
      const trackingCancelButton = document.getElementById("trackingCancelButton");
      const trackingSuccessClose = document.getElementById("trackingSuccessClose");
      const trackingPhoneInput = document.getElementById("trackingPhone");
      const trackingPhoneError = document.getElementById("trackingPhoneError");
      const trackingModalError = document.getElementById("trackingModalError");
      const trackingCtaCards = document.querySelectorAll("[id^=\"trackingCtaCard\"]");
      const trackingCtaButtons = document.querySelectorAll("[data-tracking-cta-button=\"true\"]");
      const trackingCtaStatusTags = document.querySelectorAll("[data-tracking-cta-status=\"true\"]");
      let trackingTimePref = "now";
      const requiredDocs = document.getElementById("requiredDocs");
      const processCard = document.getElementById("processCard");
      const processTag = document.getElementById("processTag");
      const processTitle = document.getElementById("processTitle");
      const processSubtitle = document.getElementById("processSubtitle");
      const processMini = document.getElementById("processMini");
      const processCta = document.getElementById("processCta");
      const processNote = document.getElementById("processNote");
      const processStepper = document.getElementById("processStepper");
      const summaryCard = document.getElementById("summaryCard");
      const summaryStatus = document.getElementById("summaryStatus");
      const summaryAmount = document.getElementById("summaryAmount");
      const summaryDate = document.getElementById("summaryDate");
      const summaryDownload = document.getElementById("summaryDownload");
      const summaryCalculateButton = document.getElementById("summaryCalculateButton");
      let processSteps = processCard ? processCard.querySelectorAll(".process-step") : [];
      let isExtendedStepper = false;
      let processStepSignature = "";
      const lawyersBlock = document.querySelector(".lawyers-block");
      const lawyersBlockHome = document.getElementById("lawyersBlockHome");
      const referencesSlot = document.getElementById("referencesSlot");
      let hasScrolledToCalculate = false;
      let hasScrolledToIhtarStep = false;
      let hasScrolledToResultSummary = false;
      let hasScrolledToResultAmount = false;
      let lastProcessStage = null;

      const BASE_PROCESS_STEPS = [
        "Belgeler alındı",
        "Bilgiler çıkarılıyor",
        "Değer kaybı tahmini",
        "İhtar dilekçesi",
      ];

      const EXTENDED_PROCESS_STEPS = [
        ...BASE_PROCESS_STEPS,
        "İhtar gönderimi 📦💰",
        "Tahkim harcı ⚖️💰",
        "Hakem atama",
        "Bilirkişi ücreti 💰",
        "Ara karar",
        "Uzman raporu 💰",
        "Bildirim",
        "İtiraz",
        "Ek rapor 💰",
        "Ek bildirim",
        "Nihai karar ⚖️",
        "Karar bildirimi",
        "Kesinleşme",
        "Ödeme takibi 💰",
        "Dosya kapanışı",
        "Yasal tahsil ⚠️💰",
      ];

      function renderProcessSteps(stepLabels, options = {}) {
        if (!processStepper) {
          return;
        }
        const { isExtended = false } = options;
        processStepper.innerHTML = stepLabels
          .map(
            (label, index) => `
              <div class="process-step pending" data-step="${index + 1}">
                <span class="process-circle">${index + 1}</span>
                <span class="process-label">${label}</span>
              </div>
            `
          )
          .join("");
        processStepper.classList.toggle("is-extended", isExtended);
        processStepper.setAttribute(
          "aria-label",
          isExtended ? "Süreç adımları (kaydırılabilir)" : "Süreç adımları"
        );
        processSteps = processStepper.querySelectorAll(".process-step");
      }

      function ensureProcessSteps(stepLabels, isExtended) {
        if (!processStepper) {
          return;
        }
        const signature = stepLabels.join("|");
        if (isExtendedStepper === isExtended && processSteps.length === stepLabels.length && signature === processStepSignature) {
          return;
        }
        renderProcessSteps(stepLabels, { isExtended });
        isExtendedStepper = isExtended;
        processStepSignature = signature;
      }

      function setUiState(state) {
        stageTwo.dataset.uiState = state;
      }

      function setResultModeLayout(isActive) {
        if (!appRoot) {
          return;
        }
        appRoot.dataset.resultMode = isActive ? "true" : "false";
        if (!isActive) {
          hasScrolledToResultSummary = false;
        }
      }

      function setPreResultModeLayout(isActive) {
        if (!appRoot) {
          return;
        }
        appRoot.dataset.preResultMode = isActive ? "true" : "false";
      }

      const PROCESS_ACTIVE_KEY = "processActive";
      const OBJECT_CREATED_KEY = "objectCreated";
      let hasStartedCalculation = false;
      let hasCreatedItem = false;
      let PIN_PROCESS_CARD = false;
      let resultModeActive = false;
      const initialPayload = resolveResultPayload(resultDataJson);
      let currentResultJson = initialPayload.raw;

      function readPersistedProcessActive() {
        try {
          const sessionValue = sessionStorage.getItem(PROCESS_ACTIVE_KEY);
          if (sessionValue !== null) {
            return sessionValue === "true";
          }
        } catch (error) {
          console.warn("processActive sessionStorage okunamadı", error);
        }
        try {
          const localValue = localStorage.getItem(PROCESS_ACTIVE_KEY);
          if (localValue !== null) {
            return localValue === "true";
          }
        } catch (error) {
          console.warn("processActive localStorage okunamadı", error);
        }
        return false;
      }

      function persistProcessActive(isActive) {
        try {
          sessionStorage.setItem(PROCESS_ACTIVE_KEY, String(isActive));
        } catch (error) {
          console.warn("processActive sessionStorage yazılamadı", error);
        }
        try {
          localStorage.setItem(PROCESS_ACTIVE_KEY, String(isActive));
        } catch (error) {
          console.warn("processActive localStorage yazılamadı", error);
        }
      }

      function readPersistedObjectCreated() {
        try {
          const sessionValue = sessionStorage.getItem(OBJECT_CREATED_KEY);
          if (sessionValue !== null) {
            return sessionValue === "true";
          }
        } catch (error) {
          console.warn("objectCreated sessionStorage okunamadı", error);
        }
        try {
          const localValue = localStorage.getItem(OBJECT_CREATED_KEY);
          if (localValue !== null) {
            return localValue === "true";
          }
        } catch (error) {
          console.warn("objectCreated localStorage okunamadı", error);
        }
        return false;
      }

      function persistObjectCreated(isCreated) {
        try {
          sessionStorage.setItem(OBJECT_CREATED_KEY, String(isCreated));
        } catch (error) {
          console.warn("objectCreated sessionStorage yazılamadı", error);
        }
        try {
          localStorage.setItem(OBJECT_CREATED_KEY, String(isCreated));
        } catch (error) {
          console.warn("objectCreated localStorage yazılamadı", error);
        }
      }

      function setProcessCardVisibility(isVisible) {
        if (!processCard) {
          return;
        }
        processCard.classList.toggle("is-hidden", !isVisible);
        processCard.setAttribute("aria-hidden", String(!isVisible));
      }

      function moveProcessCardToTop() {
        // Artık DOM sırası sabit: processCard card-grid içinde en üstte duruyor.
        // Zıplamayı önlemek için taşıma yapmıyoruz.
      }

      function placeReferences(isResultMode) {
        if (!lawyersBlock || !lawyersBlockHome || !referencesSlot) {
          return;
        }
        if (isResultMode) {
          referencesSlot.appendChild(lawyersBlock);
        } else if (lawyersBlock.parentElement !== lawyersBlockHome.parentElement) {
          lawyersBlockHome.after(lawyersBlock);
        }
      }

      function showProcessCardAtTop() {
        if (!processCard) {
          return;
        }
        hasStartedCalculation = true;
        persistProcessActive(true);
        setProcessCardVisibility(true);
        processTag.textContent = "İşleniyor";
        processTitle.textContent = "Belgeler işleniyor";
        processSubtitle.textContent = "Bu işlem sırasında aşamalar otomatik güncellenecek.";
      }

      const BUBBLE_FN_SUFFIX = "hesapla";
      const TRACKING_REQUEST_FN = "bubble_fn_takip_baslat";

      function resolveBubbleFunction(fnName) {
        if (typeof window[fnName] === "function") {
          return window[fnName];
        }
        if (window.parent && typeof window.parent[fnName] === "function") {
          return window.parent[fnName];
        }
        if (window.top && typeof window.top[fnName] === "function") {
          return window.top[fnName];
        }
        return null;
      }

      function triggerBubbleFunction(suffix, payload) {
        const fnName = `bubble_fn_${suffix}`;
        const bubbleFn = resolveBubbleFunction(fnName);
        if (typeof bubbleFn === "function") {
          if (payload === undefined || payload === null) {
            console.info(`[Bubble] ${fnName} tetikleniyor (payload yok).`);
            bubbleFn();
          } else {
            const bubblePayload = typeof payload === "string" ? payload : JSON.stringify(payload);
            console.info(`[Bubble] ${fnName} tetikleniyor (payload var).`, bubblePayload);
            bubbleFn(bubblePayload);
          }
          return true;
        }
        console.warn(`[Bubble] Fonksiyon bulunamadı: ${fnName}`);
        return false;
      }

      function setTrackingCtaVisibility(isVisible) {
        if (!trackingCtaCards || trackingCtaCards.length === 0) {
          return;
        }
        trackingCtaCards.forEach((card) => {
          card.classList.toggle("is-hidden", !isVisible);
          card.setAttribute("aria-hidden", String(!isVisible));
        });
      }

      function resetTrackingModal() {
        if (trackingPhoneInput) {
          trackingPhoneInput.value = "";
        }
        trackingTimePref = "now";
        if (trackingPhoneError) {
          trackingPhoneError.classList.add("is-hidden");
        }
        if (trackingModalError) {
          trackingModalError.classList.add("is-hidden");
        }
        if (trackingModalBody) {
          trackingModalBody.classList.remove("is-hidden");
        }
        if (trackingModalSuccess) {
          trackingModalSuccess.classList.add("is-hidden");
        }
      }

      function closeTrackingModal() {
        if (!trackingModal) {
          return;
        }
        trackingModal.classList.remove("active");
        trackingModal.setAttribute("aria-hidden", "true");
        document.body.classList.remove("modal-open");
      }

      function toggleTrackingModal(isOpen) {
        if (!trackingModal) {
          return;
        }
        if (isOpen) {
          resetTrackingModal();
          trackingModal.classList.add("active");
          trackingModal.setAttribute("aria-hidden", "false");
          document.body.classList.add("modal-open");
          return;
        }
        closeTrackingModal();
      }

      function getTrackingPayload(resultData) {
        return {
          action: "call_request",
          phone: trackingPhoneInput ? trackingPhoneInput.value.trim() : "",
          timePref: trackingTimePref,
          caseJson: resultData && resultData.DOSYALAR ? resultData.DOSYALAR : resultData,
        };
      }

      function handleTrackingSubmit() {
        if (!trackingPhoneInput) {
          return;
        }
        const phoneValue = trackingPhoneInput.value.trim();
        if (!phoneValue) {
          if (trackingPhoneError) {
            trackingPhoneError.classList.remove("is-hidden");
          }
          return;
        }
        if (trackingPhoneError) {
          trackingPhoneError.classList.add("is-hidden");
        }
        if (trackingModalError) {
          trackingModalError.classList.add("is-hidden");
        }
        const payload = getTrackingPayload(parsedResult || {});
        const triggered = triggerBubbleFunction("takip_baslat", payload);
        if (!triggered) {
          if (trackingModalError) {
            trackingModalError.classList.remove("is-hidden");
          }
          return;
        }
        if (trackingModalBody) {
          trackingModalBody.classList.add("is-hidden");
        }
        if (trackingModalSuccess) {
          trackingModalSuccess.classList.remove("is-hidden");
        }
        if (trackingCtaStatusTags && trackingCtaStatusTags.length > 0) {
          trackingCtaStatusTags.forEach((tag) => tag.classList.remove("is-hidden"));
        }
      }

      function handleCalculateClick(event) {
        const target = event && event.currentTarget ? event.currentTarget : null;
        const downloadUrl = target && target.dataset ? target.dataset.downloadUrl : "";
        if (downloadUrl) {
          window.open(downloadUrl, "_blank", "noopener");
          return;
        }
        PIN_PROCESS_CARD = true;
        hasCreatedItem = true;
        persistObjectCreated(true);
        setUiState("loading");
        setStageOneHidden(true);
        setProcessVisibility(true);
        setOutputVisibility(true);
        setProcessCardVisibility(true);
        setRequiredDocsVisibility(false);
        showProcessCardAtTop();
        if (statusStateLabel) {
          statusStateLabel.textContent = "Hesaplama sürüyor";
        }
        scrollToSummaryCard();
        triggerBubbleFunction(BUBBLE_FN_SUFFIX);
      }

      if (calculateButton) {
        calculateButton.addEventListener("click", handleCalculateClick);
      }
      if (summaryCalculateButton) {
        summaryCalculateButton.addEventListener("click", handleCalculateClick);
      }
      if (trackingCtaButtons && trackingCtaButtons.length > 0) {
        trackingCtaButtons.forEach((button) => {
          button.addEventListener("click", () => toggleTrackingModal(true));
        });
      }
      function scrollWithOffset(target, offset = 12) {
        if (!target) {
          return false;
        }
        window.requestAnimationFrame(() => {
          window.requestAnimationFrame(() => {
            const rect = target.getBoundingClientRect();
            const top = rect.top + window.pageYOffset - offset;
            window.scrollTo({ top, behavior: "smooth" });
          });
        });
        return true;
      }

      function scrollToSummaryCard() {
        if (!summaryCard) {
          return;
        }
        scrollWithOffset(summaryCard);
      }

      function scrollToCalculateButton() {
        const target = calculateButton || primaryCta;
        if (!target) {
          return;
        }
        scrollWithOffset(target);
      }

      function scrollToProcessStep(stepNumber) {
        if (!processStepper) {
          return;
        }
        const step = processStepper.querySelector(`[data-step="${stepNumber}"]`);
        if (!step) {
          return;
        }
        step.scrollIntoView({ behavior: "smooth", block: "nearest", inline: "center" });
      }

      function setCalculateButtonState(isReady) {
        if (!calculateButton) {
          return;
        }
        calculateButton.disabled = !isReady;
      }

      function setRequiredDocsVisibility(isVisible) {
        if (!requiredDocs) {
          return;
        }
        requiredDocs.classList.toggle("is-hidden", !isVisible);
        requiredDocs.setAttribute("aria-hidden", String(!isVisible));
      }

      function setRequiredDocsSecondary(isSecondary) {
        if (!requiredDocs) {
          return;
        }
        requiredDocs.classList.toggle("is-secondary", isSecondary);
      }

      function setCalculationControlsVisibility(isVisible) {
        if (calculateButton) {
          calculateButton.classList.toggle("is-hidden", !isVisible);
        }
        if (summaryCalculateButton) {
          summaryCalculateButton.classList.toggle("is-hidden", !isVisible);
        }
      }

      function hasResultPayload(payload) {
        if (payload && typeof payload === "object") {
          return Object.keys(payload).length > 0;
        }
        return typeof payload === "string" && payload.trim() !== "";
      }

      function normalizeJsonString(value) {
        if (typeof value !== "string") {
          return "";
        }
        let normalized = value.trim();
        if (!normalized) {
          return "";
        }
        if (normalized.includes("&")) {
          normalized = normalized
            .replace(/&quot;/g, '"')
            .replace(/&#34;/g, '"')
            .replace(/&apos;/g, "'")
            .replace(/&#39;/g, "'")
            .replace(/&lt;/g, "<")
            .replace(/&gt;/g, ">")
            .replace(/&amp;/g, "&");
        }
        if (normalized.startsWith("'") && normalized.endsWith("'")) {
          normalized = normalized.slice(1, -1).trim();
        }
        if (normalized && !normalized.includes('"') && normalized.includes("'")) {
          normalized = normalized.replace(/'/g, '"');
        }
        if (normalized) {
          let result = "";
          let inString = false;
          let escaped = false;
          for (let i = 0; i < normalized.length; i += 1) {
            const char = normalized[i];
            if (escaped) {
              result += char;
              escaped = false;
              continue;
            }
            if (char === "\\") {
              result += char;
              escaped = true;
              continue;
            }
            if (char === '"') {
              result += char;
              inString = !inString;
              continue;
            }
            if (inString) {
              if (char === "\n") {
                result += "\\n";
                continue;
              }
              if (char === "\r") {
                result += "\\r";
                continue;
              }
              if (char === "\t") {
                result += "\\t";
                continue;
              }
            }
            result += char;
          }
          normalized = result;
        }
        normalized = normalized.replace(/,\s*([}\]])/g, "$1");
        return normalized;
      }

      function safeParseResultData(payload) {
        if (!payload) {
          return null;
        }
        if (payload && typeof payload === "object") {
          return payload;
        }
        if (typeof payload !== "string") {
          return null;
        }
        const jsonString = normalizeJsonString(payload);
        if (!jsonString) {
          return null;
        }
        try {
          const parsed = JSON.parse(jsonString);
          if (parsed && typeof parsed === "object") {
            return parsed;
          }
          if (typeof parsed === "string") {
            const nested = normalizeJsonString(parsed);
            if (nested) {
              const reparsed = JSON.parse(nested);
              return reparsed && typeof reparsed === "object" ? reparsed : null;
            }
          }
          return null;
        } catch (error) {
          console.warn("invalid JSON", error, {
            jsonPreview: jsonString.slice(0, 200),
            jsonLength: jsonString.length,
          });
          return null;
        }
      }

      function makeSignature(obj) {
        if (!obj || typeof obj !== "object") {
          return "null";
        }
        const pick = (key) => {
          const value = getValueByKey(obj, key);
          return value === undefined || value === null ? "" : String(value);
        };
        const urlSet = new Set();
        collectUrlsFromValue(obj, urlSet);

        return [
          `urls=${urlSet.size}`,
          `ihtar=${pick("İhtar Dilekçesi")}`,
          `dk=${pick("Hesaplanan DK") || pick("Tahmini Değer Kaybı") || pick("Değer Kaybı Tutarı")}`,
          `plaka=${pick("Karşı Plaka")}`,
          `tarih=${pick("Kaza Tarihi")}`,
          `yer=${pick("Kaza Yeri")}`,
          `status=${pick("status") || pick("error")}`,
        ].join("|");
      }

      function getValueByKey(data, key) {
        if (!data || typeof data !== "object") {
          return undefined;
        }
        if (Object.prototype.hasOwnProperty.call(data, key)) {
          return data[key];
        }
        const lowerKey = key.toLowerCase();
        for (const [entryKey, entryValue] of Object.entries(data)) {
          if (entryKey.toLowerCase() === lowerKey) {
            return entryValue;
          }
        }
        return undefined;
      }

      function stableStringify(value) {
        if (value === null || value === undefined) {
          return "";
        }
        if (typeof value !== "object") {
          return String(value);
        }
        if (Array.isArray(value)) {
          return `[${value.map((item) => stableStringify(item)).join(",")}]`;
        }
        const keys = Object.keys(value).sort();
        return `{${keys.map((key) => `${key}:${stableStringify(value[key])}`).join(",")}}`;
      }

      function resolveResultPayload(rawValue) {
        if (rawValue && typeof rawValue === "object") {
          return {
            raw: stableStringify(rawValue),
            parsed: rawValue,
          };
        }
        if (typeof rawValue === "string") {
          const normalized = normalizeJsonString(rawValue);
          return {
            raw: normalized,
            parsed: safeParseResultData(normalized),
          };
        }
        return { raw: "", parsed: null };
      }

      function buildResultSignature(rawValue, parsedValue) {
        const base = parsedValue ? stableStringify(parsedValue) : "";
        const raw = typeof rawValue === "string" ? normalizeJsonString(rawValue) : "";
        return `${base}::${raw}`.trim();
      }

      function normalizeUrlList(value) {
        if (!value) {
          return [];
        }
        const entries = [];
        if (Array.isArray(value)) {
          value.forEach((item) => {
            if (typeof item === "string") {
              entries.push(item);
            }
          });
        } else if (typeof value === "string") {
          const trimmed = value.trim();
          if (trimmed.startsWith("[") && trimmed.endsWith("]")) {
            const inner = trimmed.slice(1, -1);
            entries.push(
              ...inner
                .split(";")
                .map((entry) => entry.replace(/['"]/g, "").trim())
            );
          } else {
            entries.push(
              ...trimmed
                .split(";")
                .map((entry) => entry.trim())
            );
          }
        }
        return entries
          .map((entry) => entry.trim())
          .filter((entry) => entry.length > 0);
      }

      function normalizeIhtarUrl(urlCandidate) {
        if (!urlCandidate || typeof urlCandidate !== "string") {
          return "";
        }
        const trimmed = urlCandidate.trim();
        if (!trimmed) {
          return "";
        }
        const withProtocol = trimmed.startsWith("//") ? `https:${trimmed}` : trimmed;
        if (/^https?:\/\/\S+$/i.test(withProtocol)) {
          return withProtocol;
        }
        return "";
      }

      function findFirstValidUrl(value) {
        const items = normalizeUrlList(value);
        for (const item of items) {
          const normalized = normalizeIhtarUrl(item);
          if (normalized) {
            return normalized;
          }
        }
        return "";
      }

      function getIhtarUrl(resultData) {
        if (!resultData) {
          return "";
        }
        if (typeof resultData === "string") {
          const parsed = safeParseResultData(normalizeJsonString(resultData));
          if (parsed && typeof parsed === "object") {
            return getIhtarUrl(parsed);
          }
          const lowered = resultData.toLowerCase();
          const markerIndex = lowered.indexOf("ihtar dilekçesi");
          const searchStart = markerIndex !== -1 ? markerIndex : 0;
          const httpIndex = lowered.indexOf("http", searchStart);
          if (httpIndex === -1) {
            return "";
          }
          const slice = resultData.slice(httpIndex);
          const endMatch = slice.match(/[\s"'<>]/);
          const candidate = endMatch ? slice.slice(0, endMatch.index) : slice;
          return normalizeIhtarUrl(candidate);
        }
        const ihtarValue = getValueByKey(resultData, "İhtar Dilekçesi");
        return findFirstValidUrl(ihtarValue);
      }

      function resolveIhtarUrl(parsedValue, rawValue) {
        const parsedUrl = getIhtarUrl(parsedValue);
        if (parsedUrl) {
          return parsedUrl;
        }
        if (typeof rawValue === "string") {
          return getIhtarUrl(rawValue);
        }
        return "";
      }

      function collectUrlsFromValue(value, urlSet) {
        if (!value) {
          return;
        }
        if (typeof value === "string") {
          const matches = value.match(/https?:\/\/[^\s"'<>]+/g);
          if (matches) {
            matches.forEach((match) => urlSet.add(match));
          }
          return;
        }
        if (Array.isArray(value)) {
          value.forEach((entry) => collectUrlsFromValue(entry, urlSet));
          return;
        }
        if (typeof value === "object") {
          Object.values(value).forEach((entry) => collectUrlsFromValue(entry, urlSet));
        }
      }

      function buildProcessState(resultData) {
        const BASIC_KEYS_STAGE2 = ["Karşı Ad Soyad", "Karşı Plaka", "Kaza Tarihi", "Kaza Yeri"];
        const STAGE3_KEYS = ["Hasar Onarım Tutarı", "Eksper Rp Tarihi", "Kusur Oranı", "HR Genel Hasar Toplamı"];
        const errorPresent = resultData && (resultData.status === "error" || resultData.error);

        const urlSet = new Set();
        collectUrlsFromValue(resultData, urlSet);
        const allUrls = Array.from(urlSet);
        const fileUrls = allUrls.filter((url) => /\.(pdf|png|jpg|jpeg)(\?|$)/i.test(url));

        const stage2Count = BASIC_KEYS_STAGE2.filter((key) => {
          const value = getValueByKey(resultData, key);
          return value !== undefined && value !== null && String(value).trim() !== "";
        }).length;

        const stage3Ready = STAGE3_KEYS.some((key) => {
          const value = getValueByKey(resultData, key);
          return value !== undefined && value !== null && String(value).trim() !== "";
        });

        const ihtarUrl = getIhtarUrl(resultData);

        if (errorPresent) {
          return { stage: "error" };
        }

        if (ihtarUrl) {
          return { stage: 4, ihtarUrl };
        }

        if (stage3Ready) {
          return { stage: 3 };
        }

        if (stage2Count >= 1) {
          return { stage: 2 };
        }

        if (fileUrls.length > 0) {
          return { stage: 1 };
        }

        return { stage: 0 };
      }

      function setProcessStepState(activeStep, isError, options = {}) {
        if (!processSteps || !processSteps.length) {
          return;
        }
        const { completedCount, lockActive = false } = options;
        processSteps.forEach((step) => {
          const stepNumber = Number(step.dataset.step);
          step.classList.remove("done", "active", "pending", "error");
          if (isError) {
            step.classList.add("error");
            const circle = step.querySelector(".process-circle");
            if (circle) {
              circle.textContent = String(stepNumber);
            }
            return;
          }
          const doneThreshold = completedCount !== undefined ? completedCount : activeStep - 1;
          const isDone = stepNumber <= doneThreshold;
          if (isDone) {
            step.classList.add("done");
          } else if (!lockActive && activeStep && stepNumber === activeStep) {
            step.classList.add("active");
          } else {
            step.classList.add("pending");
          }
          const circle = step.querySelector(".process-circle");
          if (circle) {
            circle.textContent = isDone ? "✓" : String(stepNumber);
          }
        });
      }

      function updateProcessUI(resultData) {
        if (!processCard || !processMini || !processCta || !processNote || !processTitle || !processSubtitle || !processTag) {
          return;
        }
        const { stage, ihtarUrl } = buildProcessState(resultData);
        if (stage !== lastProcessStage) {
          lastProcessStage = stage;
          if (stage !== 4) {
            hasScrolledToIhtarStep = false;
          }
        }
        const stepLabels = resultModeActive ? EXTENDED_PROCESS_STEPS : BASE_PROCESS_STEPS;
        ensureProcessSteps(stepLabels, resultModeActive);
        const karsiPlaka = getValueByKey(resultData, "Karşı Plaka");
        const kazaTarihi = getValueByKey(resultData, "Kaza Tarihi");
        const tahminiTutar = formatAmount(getResultAmount(resultData));

        const miniLines = [];
        if (karsiPlaka) {
          miniLines.push(`Karşı Plaka: ${karsiPlaka}`);
        }
        if (kazaTarihi) {
          miniLines.push(`Kaza Tarihi: ${kazaTarihi}`);
        }
        if (tahminiTutar) {
          miniLines.push(`Tahmini Değer Kaybı: ${tahminiTutar}`);
        }

        processMini.innerHTML = "";
        if (miniLines.length > 0) {
          processMini.classList.remove("is-hidden");
          miniLines.slice(0, 2).forEach((line) => {
            const span = document.createElement("span");
            const separatorIndex = line.indexOf(":");
            const label = separatorIndex === -1 ? line : line.slice(0, separatorIndex);
            const value = separatorIndex === -1 ? "" : line.slice(separatorIndex + 1);
            span.innerHTML = `<strong>${label.trim()}:</strong>${value ? ` ${value.trim()}` : ""}`;
            processMini.appendChild(span);
          });
        } else {
          processMini.classList.add("is-hidden");
        }

        processCta.classList.add("is-hidden");
        processNote.classList.add("is-hidden");
        processCta.removeAttribute("href");
        processCta.removeAttribute("download");

        const shouldShowProcess =
          resultModeActive || stage !== 0 || hasStartedCalculation || hasResultPayload(currentResultJson);
        setProcessCardVisibility(shouldShowProcess);
        if (shouldShowProcess) {
          moveProcessCardToTop();
        }

        if (stage === "error") {
          processTag.textContent = "Sorun oluştu";
          processTitle.textContent = "Belgeler okunamadı";
          processSubtitle.textContent =
            "Lütfen daha net/okunabilir belge yükleyin. Sorun devam ederse destek ekibimiz yardımcı olur.";
          processNote.classList.add("is-hidden");
          processCard.classList.remove("process-ready");
          setProcessStepState(1, true);
          return;
        }

        if (stage === 4) {
          processTag.textContent = "Tamamlandı";
          processTitle.textContent = "İhtar dilekçeniz hazır";
          processSubtitle.textContent = "İhtar hazır — indirebilirsiniz. Belgeler işlem bitince otomatik silinir.";
          processNote.textContent = "İhtar hazır — indirebilirsiniz. Belgeler işlem bitince otomatik silinir.";
          processNote.classList.remove("is-hidden");
          if (ihtarUrl) {
            processCta.href = ihtarUrl;
            processCta.target = "_blank";
            processCta.removeAttribute("download");
            processCta.classList.remove("is-hidden");
            try {
              scrollToSummaryCard();
            } catch (e) {}
          }
          try {
            if ("Notification" in window) {
              if (Notification.permission === "granted") {
                new Notification("İhtar dilekçeniz hazır", { body: "İndirmek için butona tıklayın." });
              } else if (Notification.permission === "default") {
                Notification.requestPermission().then((perm) => {
                  if (perm === "granted") {
                    new Notification("İhtar dilekçeniz hazır", { body: "İndirmek için butona tıklayın." });
                  }
                });
              }
            }
          } catch (e) {}
          setUiState("success");
          if (statusStateLabel) {
            statusStateLabel.textContent = "Hesaplama tamamlandı";
          }
          setProcessStepState(4, false);
          if (resultModeActive && !hasScrolledToIhtarStep) {
            hasScrolledToIhtarStep = true;
            scrollToProcessStep(4);
          }
          return;
        }

        if (stage === 3) {
          processTag.textContent = "Hazırlanıyor";
          processTitle.textContent = "Değer kaybı tahmini hazırlanıyor";
          processSubtitle.textContent =
            "Bu hesaplama bir tahmindir; nihai tutar tahkim bilirkişisiyle belirlenir.";
          processNote.textContent =
            "Sigorta başvurularında bir sigorta hukuku avukatıyla ilerlemek, hakkınızın eksik kalmamasına yardımcı olabilir.";
          processNote.classList.remove("is-hidden");
          setProcessStepState(3, false);
          return;
        }

        if (stage === 2) {
          processTag.textContent = "İşleniyor";
          processTitle.textContent = "Bilgiler çıkarılıyor";
          processSubtitle.textContent =
            "Evraklardan gerekli alanlar otomatik alınır. Eksik/okunmayan kısım varsa sizden istenir.";
          setProcessStepState(2, false);
          return;
        }

        if (stage === 1) {
          processTag.textContent = "Belgeler alındı";
          processTitle.textContent = "Belgeler alındı";
          processSubtitle.textContent = "Okunabilirlik kontrolü yapılıyor. Belgeleriniz işlem tamamlanınca silinir.";
          setProcessStepState(1, false);
          return;
        }

        if (hasStartedCalculation) {
          processTag.textContent = "İşleniyor";
          processTitle.textContent = "Belgeler işleniyor";
          processSubtitle.textContent = "Veriler geldikçe süreç adımları güncellenecek.";
        } else {
          processTag.textContent = "Bekleniyor";
          processTitle.textContent = "Belgeler bekleniyor";
          processSubtitle.textContent = "Süreç başladığında adım adım bilgilendirileceksiniz.";
        }
        setProcessStepState(1, false);
      }

      let parsedResult = initialPayload.parsed;
      function getResultAmount(resultData) {
        if (!resultData || typeof resultData !== "object") {
          return "";
        }
        if (resultData.amount) {
          return String(resultData.amount);
        }
        const candidateKeys = [
          "Tahmini Değer Kaybı",
          "Tahmini Değer Kaybı Tutarı",
          "Değer Kaybı Tutarı",
          "Deger Kaybi Tutari",
          "Tahmini Deger Kaybi Tutari",
          "Hesaplanan DK",
          "DK Tutarı",
          "DK Tutari",
          "Tazminat Tutarı",
        ];
        for (const key of candidateKeys) {
          const value = getValueByKey(resultData, key);
          if (value !== undefined && value !== null && String(value).trim() !== "") {
            return String(value);
          }
        }
        for (const [entryKey, entryValue] of Object.entries(resultData)) {
          if (typeof entryKey === "string" && /değer kaybı|deger kaybi/i.test(entryKey)) {
            if (entryValue !== undefined && entryValue !== null && String(entryValue).trim() !== "") {
              return String(entryValue);
            }
          }
        }
        return "";
      }

      function formatAmount(amountValue) {
        if (amountValue === null || amountValue === undefined) {
          return "";
        }
        const raw = String(amountValue).trim();
        if (!raw) {
          return "";
        }
        const numericCandidate = raw.replace(/[^0-9,.-]/g, "");
        const normalized = numericCandidate.replace(/\./g, "").replace(",", ".");
        const parsed = Number(normalized);
        if (!Number.isFinite(parsed)) {
          return raw;
        }
        const hasDecimal = normalized.includes(".");
        const formatted = new Intl.NumberFormat("tr-TR", {
          minimumFractionDigits: hasDecimal ? 2 : 0,
          maximumFractionDigits: hasDecimal ? 2 : 0,
        }).format(parsed);
        return `₺${formatted}`;
      }

      function getResultDate(resultData) {
        if (!resultData || typeof resultData !== "object") {
          return "";
        }
        const dateKeys = ["Hesaplama Tarihi", "Hesaplama tarihi", "İhtar Tarihi", "Tarih", "Date"];
        for (const key of dateKeys) {
          const value = getValueByKey(resultData, key);
          if (value !== undefined && value !== null && String(value).trim() !== "") {
            return String(value);
          }
        }
        return "";
      }

      function hasResultDataValue(resultData) {
        return Boolean(resultData && (getResultAmount(resultData) || resultData.status === "error"));
      }

      function isResultModeActive(resultData) {
        const ihtarUrl = getIhtarUrl(resultData);
        const amountValue = getResultAmount(resultData);
        const uiSuccess = stageTwo && stageTwo.dataset.uiState === "success";
        return Boolean(ihtarUrl || (amountValue && uiSuccess));
      }

      function applyResultModeVisibility(isActive, resultData) {
        setResultModeLayout(isActive);
        placeReferences(isActive);
        setTrackingCtaVisibility(isActive);
        if (!isActive) {
          return;
        }
        if (!hasScrolledToResultSummary) {
          hasScrolledToResultSummary = true;
          scrollToSummaryCard();
        }
        setStageOneHidden(false);
        const amountValue = getResultAmount(resultData);
        if (amountValue) {
          setUiState("success");
        }
        setSummaryVisibility(true);
        setOutputVisibility(true);
        setProcessVisibility(true);
        setProcessCardVisibility(true);
        setPrimaryCtaHidden(true);
        setCalculationControlsVisibility(false);
        if (calculateButton) {
          calculateButton.disabled = true;
        }
        if (summaryCalculateButton) {
          summaryCalculateButton.disabled = true;
        }
        if (statusStateLabel) {
          statusStateLabel.textContent = "Sonuç Hazır";
        }
      }

      function applyResultState(resultData) {
        if (resultData && resultData.status === "error") {
          setUiState("error");
          setOutputVisibility(true);
          return;
        }
        const amountValue = getResultAmount(resultData);
        if (resultData && amountValue) {
          setUiState("success");
          if (resultAmount) {
            resultAmount.textContent = formatAmount(amountValue);
          }
          const resultDateValue = getResultDate(resultData);
          if (resultDate) {
            resultDate.textContent = `Hesaplama tarihi: ${resultDateValue || "GG/AA/YYYY"}`;
          }
          setOutputVisibility(true);
          const shouldEnableResultMode = isResultModeActive(resultData);
          if (shouldEnableResultMode && !resultModeActive) {
            resultModeActive = true;
            applyResultModeVisibility(true, resultData);
          }
        }
      }

      function updateSummary(resultData, rawValue) {
        if (!summaryCard || !summaryStatus || !summaryAmount || !summaryDate || !summaryDownload) {
          return;
        }
        const ihtarUrl = resolveIhtarUrl(resultData, rawValue);
        const amountValue = getResultAmount(resultData);
        const dateValue = getResultDate(resultData);

        if (amountValue) {
          summaryAmount.textContent = formatAmount(amountValue);
          summaryStatus.textContent =
            "Hesaplama tamamlandı. Tahmini değer kaybı tutarı ve indirilebilir ihtar aşağıda.";
          if (!hasScrolledToResultAmount) {
            hasScrolledToResultAmount = true;
            scrollToSummaryCard();
          }
        } else if (hasCreatedItem) {
          summaryAmount.textContent = "₺--";
          summaryStatus.textContent =
            "Hesaplama başlatıldı. Sonuç oluştuğunda tutar ve dilekçe burada görünecek.";
          hasScrolledToResultAmount = false;
        } else {
          summaryAmount.textContent = "₺--";
          summaryStatus.textContent =
            "Henüz hesaplama yapılmadı. Evraklar yüklendiyse hesaplamayı başlatabilirsiniz.";
          hasScrolledToResultAmount = false;
        }

        summaryDate.textContent = `Hesaplama tarihi: ${dateValue || "--"}`;

        if (ihtarUrl) {
          summaryDownload.href = ihtarUrl;
          summaryDownload.classList.remove("is-hidden");
        } else {
          summaryDownload.removeAttribute("href");
          summaryDownload.classList.add("is-hidden");
        }
      }

      function applyEvrakState(isReady, resultPresent) {
        if (resultModeActive) {
          setRequiredDocsVisibility(false);
          setPreResultModeLayout(false);
          return;
        }
        setTrackingCtaVisibility(true);
        const processActive = hasStartedCalculation || PIN_PROCESS_CARD;
        const hasIhtarPayload = Boolean(resolveIhtarUrl(parsedResult, currentResultJson));
        const hasAnyPayloadLocal = hasResultPayload(currentResultJson) || hasResultDataValue(parsedResult);
        const preResultModeActive = hasAnyPayloadLocal && !hasIhtarPayload;
        setPreResultModeLayout(preResultModeActive);
        const shouldShowSummary = processActive || hasCreatedItem || hasAnyPayloadLocal || isReady;
        setSummaryVisibility(shouldShowSummary);
        setRequiredDocsSecondary(isReady);

        if (summaryCalculateButton) {
          summaryCalculateButton.disabled = hasAnyPayloadLocal || hasCreatedItem ? true : !isReady;
        }

        if ((processActive || hasCreatedItem) && !hasAnyPayloadLocal) {
          setCalculationControlsVisibility(false);
          setStageOneHidden(resultModeActive);
          setPrimaryCtaHidden(resultModeActive);
          setOutputVisibility(true);
          setProcessVisibility(true);
          setRequiredDocsVisibility(!preResultModeActive);

          setProcessCardVisibility(true);
          moveProcessCardToTop();

          if (statusStateLabel) {
            statusStateLabel.textContent = "İşlem sürüyor";
          }
          return;
        }

        if (hasAnyPayloadLocal || hasCreatedItem) {
          if (calculateButton) {
            calculateButton.disabled = true;
          }
          setCalculationControlsVisibility(false);
          setStageOneHidden(resultModeActive);
          setPrimaryCtaHidden(resultModeActive);
          setProcessVisibility(true);
          setOutputVisibility(true);
          setProcessCardVisibility(true);
          setRequiredDocsVisibility(!preResultModeActive);
          return;
        }

        setCalculationControlsVisibility(true);
        setProcessVisibility(isReady || resultPresent || hasAnyPayloadLocal);
        setProcessCardVisibility(isReady || resultPresent || hasAnyPayloadLocal);
        setSummaryVisibility(shouldShowSummary);
        setRequiredDocsVisibility(!preResultModeActive);

        if (isReady) {
          setCalculateButtonState(true);
          setPrimaryCtaHidden(false);
          if (statusStateLabel) {
            statusStateLabel.textContent = "Hesaplamaya Hazır";
          }
          if (!resultPresent) {
            setUiState("empty");
          }
          setStageOneHidden(false);
          setOutputVisibility(resultPresent);
          if (!hasScrolledToCalculate) {
            hasScrolledToCalculate = true;
            scrollToCalculateButton();
          }
        } else {
          setCalculateButtonState(false);
          setPrimaryCtaHidden(false);
          if (statusStateLabel) {
            statusStateLabel.textContent = "Belgeler kontrol ediliyor";
          }
          if (!resultPresent) {
            setUiState("empty");
          }
          setStageOneHidden(false);
          setOutputVisibility(resultPresent);
        }
      }

      const hasResultData = hasResultDataValue(parsedResult);
      const hasInitialPayload = hasResultPayload(currentResultJson);
      const hasMeaningfulPayload = hasInitialPayload || hasResultData;
      resultModeActive = isResultModeActive(parsedResult);

      let hasPersistedCreated = readPersistedObjectCreated();
      if (!hasMeaningfulPayload) {
        if (hasPersistedCreated) {
          persistObjectCreated(false);
        }
        persistProcessActive(false);
        hasPersistedCreated = false;
      }

      hasCreatedItem = hasPersistedCreated || hasMeaningfulPayload;
      if (hasCreatedItem) {
        persistObjectCreated(true);
      }

      hasStartedCalculation = readPersistedProcessActive() || hasCreatedItem;
      if (!hasInitialPayload && !hasCreatedItem) {
        persistProcessActive(false);
      }
      if (hasStartedCalculation || hasCreatedItem) {
        setProcessCardVisibility(true);
        moveProcessCardToTop();
        setOutputVisibility(true);
      }

      updateProcessUI(parsedResult);
      updateSummary(parsedResult, currentResultJson);
      applyResultModeVisibility(resultModeActive, parsedResult);
      const hasAnyPayload = hasResultPayload(currentResultJson) || Boolean(resolveIhtarUrl(parsedResult, currentResultJson));
      if (hasAnyPayload) {
        hasCreatedItem = true;
        persistObjectCreated(true);
        setProcessVisibility(true);
        setOutputVisibility(true);
        setProcessCardVisibility(true);
        setPrimaryCtaHidden(true);
        setCalculationControlsVisibility(false);
        setStageOneHidden(!resultModeActive);
      }
      applyEvrakState(evraklarYuklendi, hasResultData);
      applyResultState(parsedResult);

      function toggleModal(isOpen) {
        if (!howItWorksModal) {
          return;
        }
        howItWorksModal.classList.toggle("active", isOpen);
        howItWorksModal.setAttribute("aria-hidden", String(!isOpen));
      }

      function toggleTrustModal(isOpen) {
        if (!trustDetailsModal) {
          return;
        }
        trustDetailsModal.classList.toggle("active", isOpen);
        trustDetailsModal.setAttribute("aria-hidden", String(!isOpen));
      }

      function toggleReferencesModal(isOpen) {
        if (!referencesModal) {
          return false;
        }
        if (isOpen && referencesModalBody && lawyersBlock) {
          const clone = lawyersBlock.cloneNode(true);
          referencesModalBody.innerHTML = "";
          referencesModalBody.dataset.resultMode = appRoot && appRoot.dataset.resultMode === "true" ? "true" : "false";
          referencesModalBody.appendChild(clone);
        }
        referencesModal.classList.toggle("active", isOpen);
        referencesModal.setAttribute("aria-hidden", String(!isOpen));
        return true;
      }

      function setStageOneHidden(isHidden) {
        if (!stageOne) {
          return;
        }
        if (isHidden && stageOne.contains(document.activeElement)) {
          if (processCard) {
            processCard.focus();
          } else {
            document.body.focus();
          }
        }
        stageOne.classList.toggle("is-hidden", isHidden);
        stageOne.setAttribute("aria-hidden", String(isHidden));
        stageOne.toggleAttribute("inert", isHidden);
      }

      function setPrimaryCtaHidden(isHidden) {
        if (!primaryCta) {
          return;
        }
        primaryCta.classList.toggle("is-hidden", isHidden);
        primaryCta.setAttribute("aria-hidden", String(isHidden));
      }

      function setSummaryVisibility(isVisible) {
        if (!summaryCard) {
          return;
        }
        summaryCard.classList.toggle("is-hidden", !isVisible);
        summaryCard.setAttribute("aria-hidden", String(!isVisible));
      }

      function setOutputVisibility(isVisible) {
        if (resultCard) {
          resultCard.classList.toggle("is-hidden", !isVisible);
        }
      }

      function setProcessVisibility(isVisible) {
        if (statusCard) {
          statusCard.classList.toggle("is-hidden", !isVisible);
        }
        if (howItWorksLink) {
          howItWorksLink.classList.remove("is-hidden");
        }
      }

      if (howItWorksLink) {
        howItWorksLink.addEventListener("click", (event) => {
          event.preventDefault();
          toggleModal(true);
        });
      }

      if (trustDetailsLink) {
        trustDetailsLink.addEventListener("click", (event) => {
          event.preventDefault();
          toggleTrustModal(true);
        });
      }

      if (closeModalButton) {
        closeModalButton.addEventListener("click", () => toggleModal(false));
      }

      if (closeTrustModalButton) {
        closeTrustModalButton.addEventListener("click", () => toggleTrustModal(false));
      }

      if (closeReferencesModalButton) {
        closeReferencesModalButton.addEventListener("click", () => toggleReferencesModal(false));
      }

      if (closeTrackingModalButton) {
        closeTrackingModalButton.addEventListener("click", closeTrackingModal);
      }

      if (trackingCancelButton) {
        trackingCancelButton.addEventListener("click", closeTrackingModal);
      }

      if (trackingSuccessClose) {
        trackingSuccessClose.addEventListener("click", closeTrackingModal);
      }

      if (trackingSubmitButton) {
        trackingSubmitButton.addEventListener("click", handleTrackingSubmit);
      }

      if (trackingPhoneInput) {
        trackingPhoneInput.addEventListener("input", () => {
          if (trackingPhoneError) {
            trackingPhoneError.classList.add("is-hidden");
          }
        });
      }

      if (howItWorksModal) {
        howItWorksModal.addEventListener("click", (event) => {
          if (event.target === howItWorksModal) {
            toggleModal(false);
          }
        });
      }

      if (trustDetailsModal) {
        trustDetailsModal.addEventListener("click", (event) => {
          if (event.target === trustDetailsModal) {
            toggleTrustModal(false);
          }
        });
      }

      if (referencesModal) {
        referencesModal.addEventListener("click", (event) => {
          if (event.target === referencesModal) {
            toggleReferencesModal(false);
          }
        });
      }

      if (trackingModal) {
        trackingModal.addEventListener("click", (event) => {
          if (event.target === trackingModal) {
            closeTrackingModal();
          }
        });
      }

      const WATCHER_KEY = "__DK_WATCHER__";
      if (window[WATCHER_KEY] && typeof window[WATCHER_KEY].stop === "function") {
        window[WATCHER_KEY].stop();
      }

      const initialResultPayload = resolveResultPayload(resolveResultJsonSource());
      let lastResultJson = initialResultPayload.raw;
      let lastParsed = initialResultPayload.parsed;
      let lastSig = buildResultSignature(initialResultPayload.raw, initialResultPayload.parsed);
      let lastEvrakState = (window.EVRAKLAR_YUKLENDI === true);
      let intervalId = null;

      function tick() {
        const rawValue = resolveResultJsonSource();
        const currentEvrakState = (window.EVRAKLAR_YUKLENDI === true);
        const nextPayload = resolveResultPayload(rawValue);
        const nextParsed = nextPayload.parsed;
        const nextSig = buildResultSignature(nextPayload.raw, nextParsed);
        const changed = nextPayload.raw !== lastResultJson || nextSig !== lastSig;
        const nextResultMode = isResultModeActive(nextParsed);
        const nextHasResultData = hasResultDataValue(nextParsed);
        const nextHasPayload = hasResultPayload(rawValue) || nextHasResultData;

        if (changed) {
          currentResultJson = rawValue;
          lastResultJson = nextPayload.raw;
          lastParsed = nextParsed;
          lastSig = nextSig;
          if (!hasResultDataValue(nextParsed)) {
            hasScrolledToResultAmount = false;
          }

          parsedResult = nextParsed;
          resultModeActive = nextResultMode;
          if (nextHasPayload || Boolean(resolveIhtarUrl(nextParsed, rawValue))) {
            hasCreatedItem = true;
            persistObjectCreated(true);
            setProcessVisibility(true);
            setOutputVisibility(true);
            setProcessCardVisibility(true);
            setPrimaryCtaHidden(true);
          } else {
            persistObjectCreated(false);
            persistProcessActive(false);
            hasCreatedItem = false;
            hasStartedCalculation = false;
          }
          updateProcessUI(nextParsed);
          updateSummary(nextParsed, rawValue);
          applyResultModeVisibility(resultModeActive, nextParsed);
          applyResultState(nextParsed);
        }

        if (currentEvrakState !== lastEvrakState || changed) {
          lastEvrakState = currentEvrakState;
          evraklarYuklendi = currentEvrakState;
          resultModeActive = nextResultMode;
          applyEvrakState(currentEvrakState, hasResultDataValue(parsedResult));
        }
      }

      intervalId = window.setInterval(tick, 700);

      window[WATCHER_KEY] = {
        stop: () => {
          if (intervalId) {
            window.clearInterval(intervalId);
          }
          intervalId = null;
        },
      };
    })();
  </script>
</body>
</html>
